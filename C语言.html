<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>C&#35821;&#35328; - &#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="8684305">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">BinaryLearning</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Binary-Learning.html" class="ht-space-link">
                    <h2>&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</h2>
                </a>
                <p><br>ᴀᴜᴛʜᴏʀ: ᴋᴇʏ<br><br>不积跬步，无以至千里；<br>不积小流，无以成江海。</p>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=12714021"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Binary-Learning.html">&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</a></li>
                                                                                     <li><a href="%E5%88%9D%E7%BA%A7%E7%AF%87.html">&#21021;&#32423;&#31687;</a></li>
                                                            </ul>
</div>            <h1 id="src-12714021"> <span>C&#35821;&#35328;</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3or77nqIvmpoLopoE">
        <h1 class="heading "><span>&#35838;&#31243;&#27010;&#35201;</span></h1>
<p   
>本章课程需要具备汇编语言基础，若无汇编语言基础是无法去理解课程中所讲的一些知识点和技术细节的；同时也表示本课程是以汇编语言来理解C语言，透过本质理解高级语言。</p>
<p   
>关于本节课的环境：VC6，VC6是一个集成开发环境，使用VC6而不去使用较新的VS是因为VS会自己优化代码，而我们想要直接了解真正的本质就应该选择无添加的VC6。</p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC1D6K-t6KiA55qE5rGH57yW6KGo56S6JuWHveaVsOeahOWumuS5ieS4juiwg-eUqA">
        <h1 class="heading "><span>C&#35821;&#35328;&#30340;&#27719;&#32534;&#34920;&#31034;&amp;&#20989;&#25968;&#30340;&#23450;&#20041;&#19982;&#35843;&#29992;</span></h1>
<p   
>在了解C语言的汇编表示之前，我们要弄清楚C、C++、VC6、VS之间的关系，C和C++都属于编程语言，VC6、VS属于集成开发环境。</p>
<p   
>我们创建第一个C程序的顺序为（<strong class=" ">以下键盘快捷方式基于VC6</strong>）：</p>
<p   
>1.创建项目（选择Win32 Console Application）</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-5_18-34-38.png" alt="images/download/attachments/12714021/image2021-2-5_18-34-38.png" width="511"  />
    </p>
<p   
>2.创建文件（Source File）</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-3_19-20-31.png" alt="images/download/attachments/12714021/image2021-2-3_19-20-31.png"  height="400" />
    </p>
<p   
>3.编写入口程序</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-3_19-39-45.png" alt="images/download/attachments/12714021/image2021-2-3_19-39-45.png" width="600"  />
    </p>
<p   
>34.构建（F7）</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-3_19-40-15.png" alt="images/download/attachments/12714021/image2021-2-3_19-40-15.png" width="600"  />
    </p>
<p   
>5.运行（F5）</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-3_19-40-40.png" alt="images/download/attachments/12714021/image2021-2-3_19-40-40.png" width="600"  />
    </p>
<p   
>如下代码就是入口函数：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>在C语言中约定俗成的入口函数名称为<strong class=" ">main()</strong>，函数的格式是这样的：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">返回类型 函数名(参数列表) {</code></div>
<div class="line"><code class="plain">    函数体;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> 返回类型对应的数据; </code><code class="comments">// 执行结束</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>定义一个函数，其返回类型、函数名是必须要有的，<strong class=" ">参数列表是可有可无</strong>的，定义函数在函数体的最后一定需要使用<strong class=" ">return</strong>返回对应数据类型的数据。</p>
<p   
>关于函数名、参数名的命名也是有要求的，如下所示：</p>
<ol class=" "><li class=" "><p   
>只能以字母、数字、下划线组成；且第一个字母必须是字母或下划线。</p>
</li><li class=" "><p   
>命名严格区分大小写</p>
</li><li class=" "><p   
>不能使用C语言的关键字（例如：void、return之类）</p>
</li></ol><p   
>定义好函数之后，我们需要知道如何调用函数（使用函数），假设现在我们需要做一个加减法的程序，可以这样写：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="color1">int</code><code class="plain"> plus(</code><code class="color1">int</code><code class="plain"> x, </code><code class="color1">int</code><code class="plain"> y) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> x+y;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    plus(1,2);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>如上所示，调用函数的格式为：<strong class=" ">函数名(传入参数);</strong>，这是C语言调用函数的方法，我们之前也了解过<strong class=" ">汇编如何调用函数</strong>：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">push </code><code class="value">0x1</code></div>
<div class="line"><code class="plain">push </code><code class="value">0x2</code></div>
<div class="line"><code class="plain">call address</code></div>
</div>
    </div>
<p   
>那么C语言其调用函数的本质是什么呢？我们可以来具体看看其编译后的反汇编代码。</p>
<p   
>单击<strong class=" ">plus(1,2);</strong>那一行，按一下F9，下一个断点，然后F7构建，F5运行。</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-10_21-36-33.png" alt="images/download/attachments/12714021/image2021-2-10_21-36-33.png" width="600"  />
    </p>
<p   
>再右击这行代码，选择如下图所示的按钮，来查看反汇编代码：</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/12714021/image2021-2-10_21-37-26.png" alt="images/download/thumbnails/12714021/image2021-2-10_21-37-26.png"  height="250" />
    </p>
<p   
>通过查看反汇编代码我们发现C语言<strong class=" ">调用函数</strong>实际上跟我们之前所学的汇编是一样的：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-10_21-41-15.png" alt="images/download/attachments/12714021/image2021-2-10_21-41-15.png" width="600"  />
    </p>
<p   
>但需要注意的是，这里我们看见的反汇编代码是Debug版本，也就是方便我们调试的，而实际上程序编译应该是以Release版本，两个版本对应的汇编代码也是不一样的，另外VC6在展示反汇编代码的时，适当的做了一些优化，也就是便于阅读理解，例如上图所示的函数调用的汇编call指令，实际上就是<u class=" "><strong class=" ">call 0040100a</strong></u>。</p>
<p   
><strong class=" ">总结</strong>：函数名本质上就是编译器给内存地址起的名字。</p>
<p   
></p>
<p   
>以下汇编代码需要熟悉了解（<strong class=" ">plus函数的汇编代码实现</strong>）：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1</code><code class="plain">:</code></div>
<div class="line"><code class="value">2</code><code class="plain">:    </code><code class="keyword">int</code><code class="plain"> plus(</code><code class="keyword">int</code><code class="plain"> x, </code><code class="keyword">int</code><code class="plain"> y) {</code></div>
<div class="line"><code class="value">00401010</code><code class="plain">   push        ebp</code></div>
<div class="line"><code class="value">00401011</code><code class="plain">   mov         ebp,esp</code></div>
<div class="line"><code class="value">00401013</code><code class="plain">   sub         esp,40h</code></div>
<div class="line"><code class="value">00401016</code><code class="plain">   push        ebx</code></div>
<div class="line"><code class="value">00401017</code><code class="plain">   push        esi</code></div>
<div class="line"><code class="value">00401018</code><code class="plain">   push        edi</code></div>
<div class="line"><code class="value">00401019</code><code class="plain">   lea         edi,[ebp-40h]</code></div>
<div class="line"><code class="plain">0040101C   mov         ecx,10h</code></div>
<div class="line"><code class="value">00401021</code><code class="plain">   mov         eax,0CCCCCCCCh</code></div>
<div class="line"><code class="value">00401026</code><code class="plain">   rep stos    dword ptr [edi]</code></div>
<div class="line"><code class="value">3</code><code class="plain">:        </code><code class="keyword">return</code><code class="plain"> x+y;</code></div>
<div class="line"><code class="value">00401028</code><code class="plain">   mov         eax,dword ptr [ebp+</code><code class="value">8</code><code class="plain">]</code></div>
<div class="line"><code class="plain">0040102B   add         eax,dword ptr [ebp+0Ch]</code></div>
<div class="line"><code class="value">4</code><code class="plain">:    }</code></div>
<div class="line"><code class="plain">0040102E   pop         edi</code></div>
<div class="line"><code class="plain">0040102F   pop         esi</code></div>
<div class="line"><code class="value">00401030</code><code class="plain">   pop         ebx</code></div>
<div class="line"><code class="value">00401031</code><code class="plain">   mov         esp,ebp</code></div>
<div class="line"><code class="value">00401033</code><code class="plain">   pop         ebp</code></div>
<div class="line"><code class="value">00401034</code><code class="plain">   ret</code></div>
</div>
    </div>
<p   
></p>
<p   
>VC6的快捷键：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>下断点：F9</p>
<p   
>运行：F5</p>
<p   
>构建：F7</p>
<p   
>编译：Ctrl+F7</p>
<p   
>构建执行：Ctrl + F5</p>
<p   
>执行下一条：F10</p>
<p   
>执行下一条（步入内部）：F11</p>
<p   
>停止调试：Shift + F5</p>
        </div>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lj4LmlbDkvKDpgJLkuI7ov5Tlm57lgLw">
        <h1 class="heading "><span>&#21442;&#25968;&#20256;&#36882;&#19982;&#36820;&#22238;&#20540;</span></h1>
<p   
>在上一节中我们了解到了函数，函数的本质就是一堆指令，我们可以重复调用；函数的定义在上节中我们也已经了解了，我们举一个函数的例子：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> plus(</code><code class="keyword">int</code><code class="plain"> x, </code><code class="keyword">int</code><code class="plain"> y) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> x+y;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>在这个函数中，其参数列表有<strong class=" ">x和y</strong>，它们我们可以理解为是一个占位符，当我们想要调用函数的时候，可以使用真正的数据替换这两个占位符。（<strong class=" ">注</strong>：占位符也需要指定其数据大小，也就是数据宽度；不可以直接写作x, y）</p>
<p   
>该函数<strong class=" ">plus</strong>前面有一个<strong class=" ">int</strong>，这就表示<strong class=" ">plus</strong>函数<strong class=" ">返回类型</strong>为<strong class=" ">int</strong>类型，而<strong class=" ">int类型也是表示数据宽度</strong>，其为4个字节，除此之外还有<strong class=" ">short（2个字节）</strong>、<strong class=" ">char（1个字节）</strong>。</p>
<p   
>我们想要了解程序的本质，就需要追踪每一行到底是如何运作的，如下代码我们来进行跟踪分析<strong class=" ">plus函数</strong>是如何运行的：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="color1">int</code><code class="plain"> plus(</code><code class="color1">int</code><code class="plain"> x, </code><code class="color1">int</code><code class="plain"> y) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> x+y;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    plus(1,2);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>老规矩我们基于VC6的环境下，在调用plus函数那一行下断点（F9），然后（F7）构建，（F5）运行，右键进入汇编界面。</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-12_23-47-35.png" alt="images/download/attachments/12714021/image2021-2-12_23-47-35.png" width="600"  />
    </p>
<p   
>在这里，我们需要<strong class=" ">观察堆栈</strong>来观察程序的本质，这里可以借助<strong class=" ">Excel工具</strong>画<strong class=" ">堆栈图</strong>便于理解，我们可以选中一列然后将其边框都填上：</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/12714021/image2021-2-12_23-51-12.png" alt="images/download/thumbnails/12714021/image2021-2-12_23-51-12.png"  height="250" />
    </p>
<p   
>记住堆栈在执行前后的变化，画堆栈图要记住两个寄存器，一个是栈顶（ESP），一个是栈底（EBP）。</p>
<p   
>在我们代码（调用plus）函数还没开始执行时候要先记住这两个寄存器的值：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-12_23-54-14.png" alt="images/download/attachments/12714021/image2021-2-12_23-54-14.png" width="600"  />
    </p>
<p   
>将两个值填入我们的Excel表格中，再将其用颜色标记一下即可：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-12_23-55-52.png" alt="images/download/attachments/12714021/image2021-2-12_23-55-52.png" width="400"  />
    </p>
<p   
>接下来我们就可以按照程序执行顺序来进行跟进了，我们来看一下汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_0-1-8.png" alt="images/download/attachments/12714021/image2021-2-13_0-1-8.png" width="600"  />
    </p>
<p   
>可以看见<strong class=" ">从右到左</strong>，依次压入我们调用函数传入的参数，然后再使用call指令去调用函数，<strong class=" ">在这里我们可以使用F10跟进执行</strong>。</p>
<p   
>连续压入堆栈2个数据，堆栈也会根据数据宽度提升，此时我们要在堆栈图中根据变化进行修改：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_0-3-46.png" alt="images/download/attachments/12714021/image2021-2-13_0-3-46.png" width="400"  />
    </p>
<p   
>而我们想要跟进call指令需要使用F11跟进，就如同学习汇编时「<strong class=" ">使用DTDebug</strong>    <span style="color: #333333;">
<strong class=" ">跟进CALL指令不能使用F8要是用F7</strong>」。    </span>
</p>
<p   
>而跟进call指令之后，我们的堆栈也会发生变化，call指令下一行执行的地址会压入堆栈，栈顶也随之提升，需要注意的是在VC6中F11跟进会先过渡到一个jmp指令，然后再通过其跳到真正的函数执行地址。</p>
<p   
>    <span style="color: #333333;">
<img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_0-28-42.png" alt="images/download/attachments/12714021/image2021-2-13_0-28-42.png" width="600"  />
    </span>
</p>
<p   
>    <span style="color: #333333;">
<img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_0-48-50.png" alt="images/download/attachments/12714021/image2021-2-13_0-48-50.png" width="400"  />
    </span>
</p>
<p   
>    <span style="color: #333333;">
<img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_0-50-49.png" alt="images/download/attachments/12714021/image2021-2-13_0-50-49.png" width="600"  />
    </span>
</p>
<p   
>    <span style="color: #333333;">
接着我们再来看一下跟进的函数对应的汇编代码：    </span>
</p>
<p   
>    <span style="color: #333333;">
<img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_0-52-39.png" alt="images/download/attachments/12714021/image2021-2-13_0-52-39.png" width="400"  />
    </span>
</p>
<p   
>    <span style="color: #333333;">
在这里看到汇编代码，我们就应该知道它要干什么了，就要通过<strong class=" ">ebp进行寻址</strong>，关于这一块，在学习汇编时也有了解到，<strong class=" ">所以还是建议各位在学习本课程时候先去学习汇编</strong>。    </span>
</p>
<p   
>    <span style="color: #333333;">
我们先来看一下<strong class=" ">return之前的汇编代码</strong>：首先压入ebp到堆栈中，然后提升栈底（ebp）到栈顶（esp）的位置，再将栈顶（esp）提升<strong class=" ">0x40</strong>（十进制则表示64，堆栈图中也就是16个格子，<strong class=" ">这一块区域我们称之为缓冲区</strong>），后将ebx、esi、edi分别压入堆栈（此处是保存现场，为了函数执行完后恢复），而后lea指令是将<strong class=" ">ebp-0x40</strong>的地址（也就是esp提升<strong class=" ">0x40</strong>后的地址）给到edi，再将<strong class=" ">0x10</strong>（十进制则表示16）给到ecx（这里ecx是循环计数器），接着将<strong class=" ">0xCCCCCCCC</strong>给到eax，然后rep stosd（简写）就是将eax的值储存到edi指定的内存地址，默认情况下标志寄存器的    <span style="color: #172b4d;">
DF位为0，所以edi的值也就随循环每次递增4（dword为4字节所以是4）在这里实际上就是将哪一块缓冲区填充CC，此时堆栈图变成如下所示：    </span>
    </span>
</p>
<p   
>    <span style="color: #333333;">
    <span style="color: #172b4d;">
<img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_1-23-20.png" alt="images/download/attachments/12714021/image2021-2-13_1-23-20.png" width="400"  />
    </span>
    </span>
</p>
<p   
>    <span style="color: #333333;">
    <span style="color: #172b4d;">
为什么缓冲区填充的数据是<strong class=" ">0xCCCCCCCC</strong>？因为<strong class=" ">CC</strong>可以起到断点的作用，填充CC就是以防程序使用缓冲区时用过了，如果用过了可以及时断点；这一块包含调试器的一些知识，这里不过多阐述。    </span>
    </span>
</p>
<p   
>    <span style="color: #333333;">
<strong class=" ">return的汇编代码则很简单</strong>：通过ebp寻址获得传递的参数，ebp+8则是1，ebp+0xC则是2，最终结果在eax中。    </span>
</p>
<p   
>    <span style="color: #333333;">
当函数执行完成之后我们需要将之前压入堆栈的寄存器还原，分别pop edi &rarr; esi &rarr; ebp（堆栈遵循<strong class=" ">先入后出</strong>），而后就是恢复堆栈到函数执行之前的样子，将esp下降到ebp的位置，而后再pop ebp，还原栈底，最后ret也就是将当前栈顶的值赋给eip，然后让栈顶加4（注：这里之前使用过的数据都不会清空，如果程序运行时敏感数据存储在堆栈内则会被黑客恶意利用），但此时结束了吗？并没有，我们F10继续跟进：    </span>
</p>
<p   
>    <span style="color: #333333;">
<img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_1-37-20.png" alt="images/download/attachments/12714021/image2021-2-13_1-37-20.png" width="400"  />
    </span>
</p>
<p   
>    <span style="color: #333333;">
可以清晰的看见esp的值加0x8，此时才是遵循了堆栈平衡，还原了堆栈在函数执行前的样子。    </span>
</p>
<p   
>    <span style="color: #333333;">
<img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_1-38-42.png" alt="images/download/attachments/12714021/image2021-2-13_1-38-42.png" width="400"  />
    </span>
</p>
<p   
>    <span style="color: #333333;">
最后，我们来总结一下：    </span>
</p>
<ol class=" "><li class=" "><p   
>在C语言中参数传递是通过堆栈的，传递的顺序是从右到左</p>
</li><li class=" "><p   
>在C语言中函数返回值是存储在寄存器eax中</p>
</li></ol>    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lj5jph48">
        <h1 class="heading "><span>&#21464;&#37327;</span></h1>
<p   
>在编写程序的时候，经常需要存储数据，前面学习汇编时了解到了，数据可以存在寄存器中，或者内存中。在C语言中，存储数据要存在变量中，<strong class=" ">变量就是一个容器</strong>（通常就是内存）；变量类型决定变量内存宽度，变量名就是内存地址的编号（别名）。</p>
<p   
>声明变量的格式：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>变量类型 变量名;</p>
<p   
>注：变量类型用来说明数据宽度是多大</p>
<p   
>例：int 4字节、short 2字节、char 1字节</p>
        </div>
    </div>
<p   
>变量的命名规范与函数名、参数名一样：</p>
<ol class=" "><li class=" "><p   
>只能以字母、数字、下划线组成；且第一个字母必须是字母或下划线。</p>
</li><li class=" "><p   
>命名严格区分大小写</p>
</li><li class=" "><p   
>不能使用C语言的关键字（例如：void、return之类）</p>
</li></ol><p   
>在C语言中，变量有两类：全局变量、局部变量。</p>
<p   
><strong class=" ">全局变量</strong>：</p>
<ol class=" "><li class=" "><p   
>在函数体外定义，并且作用于全局；</p>
</li><li class=" "><p   
>在程序编译完成后，内存地址和宽度就已经确定下来了，变量名就是内存地址的别名；</p>
</li><li class=" "><p   
>只要程序启动，全局变量就已经存在，如若变量在一开始声明时没有赋值，则初始值为0；</p>
</li><li class=" "><p   
>如果不重新编译，全局变量的内存地址永远都不会变；</p>
</li><li class=" "><p   
>全局变量中的值任何程序都可以改，其最终存储的就是最后一次修改的值。</p>
</li></ol><p   
>在这里我们简单的来定义一个全局变量：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> a = </code><code class="value">123</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> plus() {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> a+</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    plus();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>我们跟进看一下反汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_2-5-44.png" alt="images/download/attachments/12714021/image2021-2-13_2-5-44.png" width="400"  />
    </p>
<p   
>全局变量a实际上就是一个内存地址，接着来看其存储的内容（<strong class=" ">0x7B转为十进制就是123</strong>）：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_2-6-51.png" alt="images/download/attachments/12714021/image2021-2-13_2-6-51.png" width="400"  />
    </p>
<p   
><strong class=" ">局部变量</strong>：</p>
<ol class=" "><li class=" "><p   
>在函数体内定义，作用于当前所在函数；</p>
</li><li class=" "><p   
>局部变量的内存是在堆栈中分配的，程序执行时才分配，不执行则不会分配，我们无法预知程序何时执行，也就意味着我们无法知道局部变量的内存地址；</p>
</li><li class=" "><p   
>不确定局部变量的内存地址，所以其也就只能作用于当前函数内部，其他函数不能使用。</p>
</li></ol>    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> plus() {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a = </code><code class="value">123</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> a+</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    plus();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>最后结论：</p>
<ol class=" "><li class=" "><p   
>全局变量是可以没有初始值直接使用的，因为系统默认给其0为初始值；</p>
</li><li class=" "><p   
>局部变量在使用前必须要赋值，因为系统不会初始化它，而只有在其赋值时才会分配内存。</p>
</li></ol>    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3lj5jph4_kuI7lj4LmlbDnmoTlhoXlrZjluIPlsYA">
        <h2 class="heading "><span>&#21464;&#37327;&#19982;&#21442;&#25968;&#30340;&#20869;&#23384;&#24067;&#23616;</span></h2>
<p   
>我们已经掌握了函数、函数调用、变量、参数、返回值等相关的一些概念，本借口我们从内存的角度来分析<strong class=" ">参数在内存中的位置</strong>、<strong class=" ">局部变量在内存中的位置</strong>、<strong class=" ">返回值是如何返回和使用的</strong>。</p>
<p   
>以下示例代码，就是一个调用函数（x+y），结果给了局部变量z，然后返回z：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> plus(</code><code class="keyword">int</code><code class="plain"> x, </code><code class="keyword">int</code><code class="plain"> y) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> z = x + y;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> z;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    plus(</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>在这里，我们还是下断点一步一步跟进，然后画堆栈图分析即可，如下是堆栈图及其对应汇编代码（<strong class=" ">这不是整个函数执行完后的堆栈图</strong>）：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_14-50-22.png" alt="images/download/attachments/12714021/image2021-2-13_14-50-22.png" width="600"  />
    </p>
<p   
>如上图所示，我们可以清晰的看见<strong class=" ">参数在内存中的位置</strong>就是ebp+8、ebp+c...以此类推；<strong class=" ">局部变量则位于我们之前所说的缓冲区</strong>，也就是ebp-4、ebp-8...以此类推，这也就是为什么局部变量使用前需赋初值，不然里面是垃圾数据（CC）。</p>
<p   
>接下来我们需要知道<strong class=" ">返回值是如何返回和使用的</strong>，在C语言中使用返回值就需要一个容器来存储这个返回值，这个容器我们也称之为变量，如下示例代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> plus(</code><code class="keyword">int</code><code class="plain"> x, </code><code class="keyword">int</code><code class="plain"> y) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> z = x + y;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> z;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">    a = plus(</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>我们来看下汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_15-0-24.png" alt="images/download/attachments/12714021/image2021-2-13_15-0-24.png" width="600"  />
    </p>
<p   
>可以看见这里会将eax放入到当前函数的缓冲区（main函数，ebp-4），也就是<strong class=" ">将返回值存到当前函数的缓冲区内</strong>。</p>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lh73mlbDltYzlpZfosIPnlKjnmoTlhoXlrZjluIPlsYA">
        <h1 class="heading "><span>&#20989;&#25968;&#23884;&#22871;&#35843;&#29992;&#30340;&#20869;&#23384;&#24067;&#23616;</span></h1>
<p   
>函数嵌套调用实际上就是函数中调用另外一个函数，以下为示例代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> plus1(</code><code class="keyword">int</code><code class="plain"> x, </code><code class="keyword">int</code><code class="plain"> y) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> x+y;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> plus(</code><code class="keyword">int</code><code class="plain"> x, </code><code class="keyword">int</code><code class="plain"> y, </code><code class="keyword">int</code><code class="plain"> z) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> r;</code></div>
<div class="line"><code class="plain">    r = plus1(x,y);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> r+z;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">    a = plus(</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>老规矩我们还是在plus函数那下断点跟踪画堆栈图，如下是堆栈图：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-13_15-24-35.png" alt="images/download/attachments/12714021/image2021-2-13_15-24-35.png" width="500"  />
    </p>
<p   
>在调用完plus1函数后，plus函数会有这样一个汇编代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">00401094</code><code class="plain">   add         esp,44h</code></div>
<div class="line"><code class="value">00401097</code><code class="plain">   cmp         ebp,esp</code></div>
<div class="line"><code class="value">00401099</code><code class="plain">   call        __chkesp (004010b0)</code></div>
</div>
    </div>
<p   
>需要注意的是这个代码只有Debug版本才会有，而在Release版本中堆栈的布局与这是不一样的。</p>
<p   
>这段代码的意思就是对比esp和ebp是否一样，而我们知道堆栈在使用完成之后要恢复成员来的样子（堆栈平衡），所以在add指令之后ebp与esp应该是一样的，而后的call指令实际上就是调用了一个函数（__chkesp），这个函数就是用来<strong class=" ">检查你的堆栈是否平衡</strong>的。</p>
<p   
>至此，我们就了解了函数嵌套调用的内存布局，但实际上我们在之前<strong class=" ">就已经了解过了</strong>，因为main本身也是一个函数，main调用了plus也属于函数嵌套调用，只不过我们画堆栈图是在调用plus之前画的，所以忽略了这一点。</p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mlbTmlbDnsbvlnos">
        <h1 class="heading "><span>&#25972;&#25968;&#31867;&#22411;</span></h1>
<p   
>在之前的课程中我们提到了变量，变量就是一种容器，我们可以存储数据在里面，里面的数据也可以被我们修改；但是这个容器能存储多少数据，存储什么样格式的数据就取决于变量类型（数据类型）。</p>
<p   
>在C语言中变量类型有这几种：</p>
<ol class=" "><li class=" "><p   
>基本类型：整数、浮点</p>
</li><li class=" "><p   
>构造类型：数组、结构体、共用体（联合）</p>
</li><li class=" "><p   
>指针类型</p>
</li><li class=" "><p   
>空类型：void</p>
</li></ol><p   
>这节课我们先来学习以下整数类型：</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>名称</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>数据宽度</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>数据范围</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>char</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>8BIT = 1字节</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0 - 0xFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>short</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>16BIT = 2字节</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0 - 0xFFFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>int</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>32BIT = 4字节</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0 - 0xFFFFFFFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>long</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>32BIT = 4字节</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0 - 0xFFFFFFFF</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
><strong class=" ">注</strong>：int在16位计算机中与short宽度一样，在32位及以上的计算机中与long相同。</p>
<p   
>如果我们存储的数据宽度比变量的数据宽度大就会出现<strong class=" ">数据溢出</strong>，如下示例代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> x = </code><code class="value">0x100</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>这种情况下，数据是如何存储的呢？我们还可以来看一下汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-17_23-13-28.png" alt="images/download/attachments/12714021/image2021-2-17_23-13-28.png" width="500"  />
    </p>
<p   
>可以看见这里在汇编中直接存储的是0（<strong class=" ">十六进制</strong>），因为这里的数据宽度是1个字节，也就是8位二进制，其二进制则为0000 0000，100我们可以转为二进制：0001 0000 0000</p>
<p   
>由此得出一个结论：<strong class=" ">当数据存储超出其数据宽度造成数据溢出时，存储数据舍弃高位，存储低位</strong>。以上例子可能不明显，可以看如下例子：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-17_23-18-7.png" alt="images/download/attachments/12714021/image2021-2-17_23-18-7.png" width="500"  />
    </p>
<p   
></p>
<p   
>整数的存储格式如下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> x = </code><code class="value">1</code><code class="plain">; </code><code class="comments">// 0000 0001</code></div>
<div class="line"><code class="keyword">char</code><code class="plain"> x = -</code><code class="value">1</code><code class="plain">; </code><code class="comments">// 1111 1111</code></div>
</div>
    </div>
<p   
>至于为什么这样存储，还需要去回顾一下「<strong class=" ">原码、反码、补码</strong>」的相关知识。</p>
<p   
></p>
<p   
>在之前的汇编学习中，我们了解到有符号数和无符号数，同样在C语言中，也可以表示有符号数与无符号数，<strong class=" ">在C语言中不添加如下关键词，默认就是有符号数</strong>：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">signed </code><code class="keyword">char</code><code class="plain"> x = -</code><code class="value">1</code><code class="plain">; </code><code class="comments">// 有符号数</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">unsigned </code><code class="keyword">char</code><code class="plain"> a = -</code><code class="value">1</code><code class="plain">; </code><code class="comments">// 无符号数</code></div>
</div>
    </div>
<p   
>在什么时候去使用有符号、无符号呢？</p>
<ol class=" "><li class=" "><p   
>有符号：涉及负数的领域，如炒股</p>
</li><li class=" "><p   
>无符号：无负数的领域，如年龄</p>
</li></ol><p   
>如上代码，我们可以看下反汇编：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-18_0-15-53.png" alt="images/download/attachments/12714021/image2021-2-18_0-15-53.png" width="500"  />
    </p>
<p   
>这时候，可能会有人疑惑，为什么定义了变量a为无符号数，存储-1的内容还是0xFF呢？这是因为<strong class=" ">在编译器中，不管你是如何定义这个数的，只要看见-1，那么一定会以其补码形式存储</strong>。</p>
<p   
>有符号数与无符号数存储数据是没有区别的，只有在扩展与比较时才会存在区别。</p>
<p   
>如下示例代码，定义一个char类型的变量，再赋值给一个int类型的变量：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> x = -</code><code class="value">1</code><code class="plain">; </code><code class="comments">// 0xFF 1111 1111</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> y = x;</code></div>
</div>
    </div>
<p   
>因为<strong class=" ">在C语言中不添加如下关键词，默认就是有符号数</strong>，所以这里就是两个有符号数的赋值，变量x给到y，y的值就是0xFFFFFFFF，这是为什么？int类型代表4个字节，也就是32位二进制数：0000 0000 0000 0000 0000 0000 0000 0000，在这里x为1111 1111，那么二进制数为：二进制数：<strong class=" ">0000 0000 0000 0000 0000 0000 1111 1111</strong>，但由于这是一个有符号数，所以其余位为符号位，也就是1，最终二进制数为：<strong class=" ">1111 1111 1111 1111 1111 1111 1111 1111</strong>，也就是<strong class=" ">0xFFFFFFFF</strong>。</p>
<p   
>无符号数则不需要如此：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">unsigned </code><code class="keyword">char</code><code class="plain"> x = -</code><code class="value">1</code><code class="plain">; </code><code class="comments">// 0xFF 1111 1111</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> y = x;</code></div>
</div>
    </div>
<p   
>这里最后变量y的值则为255，也就是<strong class=" ">0000 0000 0000 0000 0000 0000 1111 1111</strong>。</p>
<p   
></p>
<p   
>在比较时候也存在区别，例如：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> a = </code><code class="value">1</code><code class="plain">; </code><code class="comments">// 0x1</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> b = -</code><code class="value">1</code><code class="plain">; </code><code class="comments">// 0xFF</code></div>
</div>
    </div>
<p   
>这里是有符号数比较a和b，a确实是大于b的，但无符号数不一样：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">unsigned </code><code class="keyword">int</code><code class="plain"> a = </code><code class="value">1</code><code class="plain">; </code><code class="comments">// 0x1 1</code></div>
<div class="line"><code class="plain">unsigned </code><code class="keyword">int</code><code class="plain"> b = -</code><code class="value">1</code><code class="plain">; </code><code class="comments">// 0xFF 255</code></div>
</div>
    </div>
<p   
>这里在比较，则b大于a。</p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mta7ngrnnsbvlnos">
        <h1 class="heading "><span>&#28014;&#28857;&#31867;&#22411;</span></h1>
<p   
>浮点类型分为这几类：</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>名称</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>数据宽度</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>float</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>32BIT = 4字节</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>double</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>32BIT = 8字节</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>long double</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>32BIT = 8字节（在某些平台的编译器中可能是16个字节）</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>建议赋值方式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">float</code><code class="plain"> a = </code><code class="value">1</code><code class="plain">.23F;</code></div>
<div class="line"><code class="keyword">double</code><code class="plain"> b = </code><code class="value">2.34</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">long</code><code class="plain"> </code><code class="keyword">double</code><code class="plain"> c = </code><code class="value">2</code><code class="plain">.34L;</code></div>
</div>
    </div>
<p   
>我们在日常使用中最常用的就是float、double类型；会有人好奇，为什么在这里要在数据最后加上F或L？就以float举例，如果不加上F，编译器默认会认为这个值是double，然后再转换赋值给float。</p>
<p   
></p>
<p   
>float和double在存储的方式上都遵从IEEE编码规范：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-18_16-12-42.png" alt="images/download/attachments/12714021/image2021-2-18_16-12-42.png"  height="250" />
    </p>
<p   
>我们主要了解一下float类型的存储格式即可，其他类型举一反三都可以进行推演。</p>
<p   
>这里我们举例说明8.25转成浮点存储，整数部分8不断的除以2，直到结果为0，整除不包含小数点，所以最后的1/2结果为0，有余数则为1。</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/12714021/image2021-2-18_16-16-28.png" alt="images/download/thumbnails/12714021/image2021-2-18_16-16-28.png" width="300"  />
    </p>
<p   
>从下往上读，由此可以得出8的二进制为1000，我们还可以来算一下9的二进制：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>9/2 = 4 1</p>
<p   
>4/2 = 2 0</p>
<p   
>2/2 = 1 0</p>
<p   
>1/2 = 0 1</p>
        </div>
    </div>
<p   
>得出9的二进制为1001，得出结论：<strong class=" ">所有的整数一定可以完整的转换为二进制</strong>。</p>
<p   
>8.25转成浮点存储，小数部分这样计算：</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/12714021/image2021-2-18_16-22-43.png" alt="images/download/thumbnails/12714021/image2021-2-18_16-22-43.png" width="300"  />
    </p>
<p   
>小数部分0.25不断的乘以2，直到结果小数点为0，例如：1.0，而如果大于1.0则二进制位也为1，其余都是0，这里我们以0.4为例子：</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/12714021/image2021-2-18_16-23-3.png" alt="images/download/thumbnails/12714021/image2021-2-18_16-23-3.png" width="300"  />
    </p>
<p   
>0.8*2=1.6，1.6的1拿走则表示二进制位为1，然后再乘以2，以此类推...但是这里我们发现这里就进入了循环状态，一直都是0110，永远无法得到结果小数点为0的情况。</p>
<p   
>由此得出结论：<strong class=" ">用二进制描述小数，不可能做到完全精确，就像用十进制描述1/3一样</strong>。</p>
<p   
>将一个float型转化为内存存储格式的步骤：</p>
<p   
></p>
<ul class=" "><li class=" "><p   
>先将这个实数的绝对值化为二进制格式</p>
</li><li class=" "><p   
>将这个二进制格式的实数的小数点左移或者右移N位，直到小数点移动到第一个有效数字的右边</p>
</li><li class=" "><p   
>从小数点右边第一位开始数出二十三位数字放入第22到第0位</p>
</li><li class=" "><p   
>如果实数是正的，则第31位放入&ldquo;0&rdquo;，否则放入 &ldquo;1&rdquo;</p>
</li><li class=" "><p   
>如果n是左移得到的，说明指数是正的，第30位放入&ldquo;1&rdquo;，如果n是右移得到的或n=0，则第30位放入&ldquo;0&rdquo;</p>
</li><li class=" "><p   
>如果n是左移得到的，则n减去1后化为二进制，并在左边加&ldquo;0&rdquo;补足七位，放入第29到第23位</p>
</li><li class=" "><p   
>如果n是右移得到的或n=0,则将n化为二进制后在左边加&ldquo;0&rdquo;补足七位，再各位求反，再放入第29到第23位</p>
</li></ul><p   
></p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>8.25 -&gt; 100.01 -&gt; 1.00001 * 2的三次方(指数是3)</p>
<p   
>科学计数法</p>
<p   
>10 = 1 * 10一次方 指数:1<br/>100 = 1 * 10的二次方 指数:2<br/>1000 = 1 * 10的三次方 指数:3</p>
<p   
>填充表格(flot)</p>
<p   
>符号位(1) 指数部分(8) 尾数部分(23)</p>
<p   
>0 10000010 000 0100 0000 0000 0000 0000</p>
<p   
>16进制表示: 0x4104 0000</p>
<p   
></p>
<p   
>尾数部分：经过第一步转换后 8.25等于 1.00001 * 2的三次方(指数是3)</p>
<p   
>尾数直接从前往后放所以尾数是：000 0100 0000 0000 0000 0000</p>
<p   
></p>
<p   
>指数部分：</p>
<p   
>首位表示小数点移动方向</p>
<p   
>向左移动则为1，向右为0</p>
<p   
></p>
<p   
>指数部分简单方法:</p>
<p   
>不论左移还是右移。一律把指数 +127 然后取2进制</p>
<p   
>左移了三次，指数为3,3的二进制是11，但是这里要减去1</p>
<p   
>所以指数部分为 1000 0010</p>
        </div>
    </div>
<p   
><strong class=" ">浮点类型的精度</strong>：</p>
<ol class=" "><li class=" "><p   
>float和double的精度是由尾数的位数来决定的；</p>
</li><li class=" "><p   
>float : 2^23 = 8388608 一共7位，这意味着最多能有7位有效数字；</p>
</li><li class=" "><p   
>double : 2^52 = 4503599627370496 一共16位，这意味着最多能有16位有效数字。</p>
</li></ol>    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lrZfnrKbkuI7lrZfnrKbkuLI">
        <h1 class="heading "><span>&#23383;&#31526;&#19982;&#23383;&#31526;&#20018;</span></h1>
<p   
>在之前的课程中我们了解到变量的定义决定两个事情，第一是决定存储的数据宽度，第二是决定了存储的数据格式，那么我们来看下下面的代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> a = </code><code class="value">123</code><code class="plain">; </code><code class="comments">// 变量x，数据宽度为4个字节，里面存储的是补码（在计算机系统中，数值一律用补码来存储）</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> </code><code class="keyword">float</code><code class="plain"> b = </code><code class="value">123</code><code class="plain">.4F; </code><code class="comments">// IEEE编码（浮点）</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> c = </code><code class="string">'A'</code><code class="plain">; </code><code class="comments">// 那这个存储的是啥？</code></div>
</div>
    </div>
<p   
>我们在代码中写了变量c，但是它最终存储进去的是啥呢？我们看下反汇编：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-19_0-51-43.png" alt="images/download/attachments/12714021/image2021-2-19_0-51-43.png" width="500"  />
    </p>
<p   
>在这里'A'存储的时候变成了0x41，这是为什么？因为它是一个字符，这里需要注意在变量定义赋值时，赋值字符需要加上单引号。</p>
<p   
>在内存中所有东西最终都会变成0和1，A对应0x41，那么可以大胆猜测一下B就是对应0x42，当我们使用字符存储到内存时，字符自然是没办法存储到内存中的，这时候就有了一个字符对应的表：ASCII表（美国标准信息交换代码）</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-19_0-56-21.png" alt="images/download/attachments/12714021/image2021-2-19_0-56-21.png" width="500"  />
    </p>
<p   
>这张表有128个符号，都是比较常用的，那也就是说在我们赋值A给变量时，编译器会去这张表中寻找大写的A，如上图所示A对应10进制为65，转为16进制就是0x41。</p>
<p   
>值得注意的是在这张表中最多也就是占用一个字节的宽度，所以我们完全没有必要使用int来存储字符，可以选择char，例如：<u class=" "><strong class=" ">char a = 'A';</strong></u></p>
<p   
>在很多书中会描述char就是用来存储字符的，<strong class=" ">这是一个错误的说法</strong>，数据的存储是由使用者决定的而不是计算机。</p>
<p   
>C语言会自带很多函数提供我们使用，我们想要在控制台中输出一个字符，可以使用putchar这个函数：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">putchar(</code><code class="value">65</code><code class="plain">);</code></div>
<div class="line"><code class="plain">putchar(</code><code class="string">'A'</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>如上代码就是输出一个字符A，这样我们就了解了这个函数的运行本质：将对应数从ASCII表中查出画在(打印)控制台上；需要注意该函数一次只能打印一个字符。</p>
<p   
>除了这个函数外还有一个打印输出的函数：printf，它就可以一次性打印多个字符。</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Hello World!\n"</code><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x = </code><code class="value">0xFFFFFFFF</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d %u %x\n"</code><code class="plain">,x,x,x);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// -1  4294967295  ffffffff</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">float</code><code class="plain"> f = </code><code class="value">3</code><code class="plain">.1415F;</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%6.2f\n"</code><code class="plain">,f);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3.14</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>使用printf函数需要在代码开头写<u class=" "><strong class=" ">#include &lt;stdio.h&gt;</strong></u>，三个printf分别表示输出字符串、整数、浮点数。</p>
<p   
>有心之人可能会发现在使用printf函数时，有好几个百分号的东西，这就叫做占位符，一共分为如下这几种：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>%d 有符号数形式打印</p>
<p   
>%u 无符号形式打印</p>
<p   
>%x 16进制形式打印</p>
<p   
>%{x.y}f 打印浮点数 x标志打印总长度 y 代表小数点后长度</p>
        </div>
    </div>
<p   
>看过示例代码之后，我们就知道了<strong class=" ">字符串本质上就是一堆字符连续串在一块</strong>，观察一下反汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-19_1-19-37.png" alt="images/download/attachments/12714021/image2021-2-19_1-19-37.png" width="600"  />
    </p>
<p   
>这时候就存在一个问题，printf为什么会知道打印完最后一个感叹号之后就不打印了呢？这是因为在这一串字符串后存在着一个00，当printf看见之后就会停止打印了，也就是说字符串的结束标志在内存中是00。</p>
<p   
>我们想使用char类型来存储字符串，就需要用到数组，例如：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> buffer[</code><code class="value">20</code><code class="plain">] = </code><code class="string">"Hello World!"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%s\n"</code><code class="plain">,buffer);</code></div>
</div>
    </div>
<p   
>这就表示buffer可以存储20个字符，%s是占位符，表示以字符串形式打印，关于数组的细节后面的课程中会学习到，这里了解一下即可。</p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3kuK3mloflrZfnrKY">
        <h1 class="heading "><span>&#20013;&#25991;&#23383;&#31526;</span></h1>
<p   
>在之前了解到ASCII码表中，我们并没有发现存在中文，那么如何在计算机中存储中文？这时候我们需要了解一个新的表：拓展ASCII码表 (EASCII)</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-19_1-27-21.png" alt="images/download/attachments/12714021/image2021-2-19_1-27-21.png" width="600"  />
    </p>
<p   
>该表十进制值从128到255，但是这些也没办法满足我们中文的需求，所以天朝专家把那些127号后的奇异符号们 (即EASCII)取消掉，规定：一个小于127的字符意义与原来相同，但是两个大于127的字符连在一起时，就表示一个汉字，这样我们就可以组合出大约7000多个简体汉字了。</p>
<p   
>在这些编码里，连在ASCII里本来就有的数字、标点、字母都统统编了两个字节长的编码，这就是常说的&rdquo;全角&ldquo;字符，而原来在127号以下的那些就叫&rdquo;半角&ldquo;字符了，上述编码规则就是GB2312或GB2312-80。</p>
<p   
>GB2312或GB2312-80，两种编码可能使用相同的数字代表两个不同的符号，或者使用相同的数字代表不同的符号，这种编码方式有很大的弊端，当此种编码方式的数据在其他国家使用的时候，如果其他国家使用类似的编码规则，<strong class=" ">那么数据就会失去原本的意义</strong>。</p>
<p   
>而前辈们早就发现了这种情况，因此<strong class=" ">Unicode编码</strong>就是为了解决这个问题才出现的。</p>
<p   
>在C语言中写入中文与其他字符串没区别，但我们了解过GB2312或GB2312-80编码规则后，就要知道一个中文代表2个字节：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> buffer[</code><code class="value">20</code><code class="plain">] = </code><code class="string">"中国"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%s\n"</code><code class="plain">,buffer);</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-19_1-33-38.png" alt="images/download/attachments/12714021/image2021-2-19_1-33-38.png"  height="150" />
    </p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3ov5DnrpfnrKbkuI7ooajovr7lvI8">
        <h1 class="heading "><span>&#36816;&#31639;&#31526;&#19982;&#34920;&#36798;&#24335;</span></h1>
<p   
>什么是运算符？什么是表达式？运算符：加减乘除、大于小于等于、赋值，表达式则是由运算符和变量组成，如下代码示例，从x+y开始都是表达式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> x,y;</code></div>
<div class="line"><code class="plain">x = </code><code class="value">12</code><code class="plain">;y = </code><code class="value">23</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">x+y;x-y;x&lt;y;x=y;x==y;</code></div>
</div>
    </div>
<p   
>如果x和y类型不同，最终结果按照这个顺序进行结果类型转换：<strong class=" ">char =&gt; short =&gt; int =&gt; float =&gt; double</strong>；我们可以举例说明：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> x = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">short</code><code class="plain"> y = </code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> z = x + y;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>对应反编码代码为：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">00410938</code><code class="plain">   mov         </code><code class="keyword">byte</code><code class="plain"> ptr [ebp-</code><code class="value">4</code><code class="plain">],</code><code class="value">1</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">0041093C   mov         word ptr [ebp-</code><code class="value">8</code><code class="plain">],offset main+20h (</code><code class="value">00410940</code><code class="plain">)</code></div>
<div class="line"> </div>
<div class="line"><code class="value">00410942</code><code class="plain">   movsx       eax,</code><code class="keyword">byte</code><code class="plain"> ptr [ebp-</code><code class="value">4</code><code class="plain">]</code></div>
<div class="line"><code class="value">00410946</code><code class="plain">   movsx       ecx,word ptr [ebp-</code><code class="value">8</code><code class="plain">]</code></div>
<div class="line"><code class="plain">0041094A   add         eax,ecx</code></div>
<div class="line"><code class="plain">0041094C   mov         dword ptr [ebp-0Ch],eax</code></div>
</div>
    </div>
<p   
>通过汇编代码我们明显可以看出其结果类型的转换。另外需要注意的是：表达式不论怎么复杂，最终只有一个结果。</p>
<p   
>首先我们来了解一下<strong class=" ">一些常用的运算符</strong>。</p>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3nrpfmlbDov5DnrpfnrKY">
        <h2 class="heading "><span>&#31639;&#25968;&#36816;&#31639;&#31526;</span></h2>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="38.0"/>
                                    <col  width="35.0"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>加</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>减</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>乘</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>除</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>取余</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>自加</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>自减</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>+</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>-</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>*</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>/</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>%</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>++</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>--</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>加减乘除、取余都很简单，我们要了解一下自加、自减的用法：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> i = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">++i;</code></div>
<div class="line"><code class="plain">i++;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">--i;</code></div>
<div class="line"><code class="plain">i--;</code></div>
</div>
    </div>
<p   
>如上就是自加、自减的用法，注意<strong class=" ">自加、自减的</strong>都是1，但其符号为什么可以在变量前或变量后？既然可以这样，其二者区别是什么？我们可以来看一下反汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-21_23-29-48.png" alt="images/download/attachments/12714021/image2021-2-21_23-29-48.png" width="400"  />
    </p>
<p   
>通过反汇编代码我们看不出来其存在什么差别，我们可以借助printf函数来查看区别：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> i = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d \n"</code><code class="plain">, i++);</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d \n"</code><code class="plain">, ++i);</code></div>
</div>
    </div>
<p   
>运行一下来看看效果：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-21_23-35-37.png" alt="images/download/attachments/12714021/image2021-2-21_23-35-37.png" width="500"  />
    </p>
<p   
>可以看见第一个输出了1，第二个输出了3，那么我们可以暂时认为：<strong class=" ">自加、自减符号在前则自加、自减完返回，符号在前则先返回当前值，然后再自加、自减</strong>；具体的，我们来看一下反汇编代码便可得知：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-21_23-38-19.png" alt="images/download/attachments/12714021/image2021-2-21_23-38-19.png" width="500"  />
    </p>
<p   
>如上图反汇编代码便可说明我们的猜测是正确的。</p>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3lhbPns7vov5DnrpfnrKY">
        <h2 class="heading "><span>&#20851;&#31995;&#36816;&#31639;&#31526;</span></h2>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="38.0"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>小于</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>小于等于</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>大于</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>大于等于</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>等于</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>不等于</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&lt;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&lt;=</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&gt;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&gt;=</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>==</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>!=</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p  class="auto-cursor-target" 
>示例代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> i;</code></div>
<div class="line"><code class="plain">i = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">a = </code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">i&lt;a;</code></div>
<div class="line"><code class="plain">a&gt;i;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">i&lt;=a;</code></div>
<div class="line"><code class="plain">a&gt;=i;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">...</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
>注意：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>关系运算符的值只能是0或1</p>
<p   
>关系运算符的值为真时，结果值都为1</p>
<p   
>关系运算符的值为假时，结果值都为0</p>
        </div>
    </div>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3pgLvovpHov5DnrpfnrKY">
        <h2 class="heading "><span>&#36923;&#36753;&#36816;&#31639;&#31526;</span></h2>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                                    <col  width="35.0"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>非</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>逻辑与</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>逻辑或</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>!</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&amp;&amp;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>||</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>示例代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> a = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> b = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> c = !a;</code></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><code class="plain">a &amp;&amp; b;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">a&lt;b &amp;&amp; b&gt;a;</code></div>
</div>
    </div>
<p   
>注意：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>&amp;&amp; 和 ||，使用时左右两边的结果相与、相或，结果最终只有一个。</p>
        </div>
    </div>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3kvY3ov5DnrpfnrKY">
        <h2 class="heading "><span>&#20301;&#36816;&#31639;&#31526;</span></h2>
    <div  class="tablewrap">
        <table class="relative-table wrapped confluenceTable">
                    <colgroup>
                                    <col  width="17.5342%"/>
                                    <col  width="17.5266%"/>
                                    <col  width="16.0046%"/>
                                    <col  width="16.0046%"/>
                                    <col  width="16.9254%"/>
                                    <col  width="16.0046%"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>左移</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>右移</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>非</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>或</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>异或</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>与</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&lt;&lt;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&gt;&gt;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>~</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>|</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>^</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&amp;</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>位运算在汇编的学习中有提到，这里不过多赘述。</p>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3otYvlgLzov5DnrpfnrKY">
        <h2 class="heading "><span>&#36171;&#20540;&#36816;&#31639;&#31526;</span></h2>
    <div  class="tablewrap">
        <table class="relative-table wrapped confluenceTable">
                    <colgroup>
                                    <col  width="17.5342%"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>赋值</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>=</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3mnaHku7bov5DnrpfnrKY">
        <h2 class="heading "><span>&#26465;&#20214;&#36816;&#31639;&#31526;</span></h2>
<p   
>条件运算符又称为三元运算符，由问号、分号组成，示例代码如下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> a;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">a = </code><code class="value">1</code><code class="plain">&gt;</code><code class="value">2</code><code class="plain"> ? </code><code class="value">1</code><code class="plain"> : </code><code class="value">0</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>我们看下反汇编，变量a最终的值是什么：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-22_0-4-33.png" alt="images/download/attachments/12714021/image2021-2-22_0-4-33.png" width="400"  />
    </p>
<p   
>最终值为0，那么可以得出这样一个结论：<strong class=" ">1&gt;2为表达式，表达式成立则执行问号后面的内容，不成立则执行冒号后面的内容</strong>。</p>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3liIbmlK_or63lj6U">
        <h1 class="heading "><span>&#20998;&#25903;&#35821;&#21477;</span></h1>
<p   
>大家都知道在C语言当中，代码就是按照入口函数体内从上到下的顺序开始执行的，我们想要控制执行的顺序可以使用分支语句、循环语句进行控制，本节课我们就来学习一下分支语句。</p>
<p   
>最简单的分支语句就是：if，示例代码如下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> a = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> b = </code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">if</code><code class="plain"> (a &lt; b) {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="value">1</code><code class="plain">);</code></div>
<div class="line"><code class="plain">} </code><code class="keyword">else</code><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (a &gt; b) {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">} </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="value">3</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>这段代码的意思就是进入if语句，如果a小于b则打印一个1，如果a大于b则打印一个2，如果前两2个表达式都不成立则打印一个3；在这里我们简单来看一下反汇编代码，看看它如何实现的：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-22_0-13-27.png" alt="images/download/attachments/12714021/image2021-2-22_0-13-27.png" width="500"  />
    </p>
<p   
>如上反汇编代码可以看的出来，虽然我们C语言写的是x&gt;y，但是jle这个指令实际意义是当小于等于则跳转到0040d73d这个执行地址，我们没有必要去记住C语言对应的反汇编代码的结构，也不需要去记住，因为实际环境很有可能不是这样实现的，只要了解一个大概即可。</p>
<p   
><strong class=" ">注意</strong>：分支语句中可以嵌套分支语句，具体实现的功能看使用者。</p>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC1Td2l0Y2jor63lj6U">
        <h2 class="heading "><span>Switch&#35821;&#21477;</span></h2>
<p   
>Switch语句也是分支语句的一种，其语法如下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">switch</code><code class="plain">(表达式)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">case</code><code class="plain"> 常量表达式1:</code></div>
<div class="line"><code class="plain">        语句;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">case</code><code class="plain"> 常量表达式:</code></div>
<div class="line"><code class="plain">        语句;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">case</code><code class="plain"> 常量表达式:</code></div>
<div class="line"><code class="plain">        语句;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    ......</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">default</code><code class="plain">:</code></div>
<div class="line"><code class="plain">        语句;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><strong class=" ">需要注意如下几点：</strong></p>
<ol class=" "><li class=" "><p   
>表达式结束不能是浮点数</p>
</li><li class=" "><p   
>case后的常量值不能一样</p>
</li><li class=" "><p   
>case后的值必须是常量</p>
</li><li class=" "><p   
>break非常重要，当执行到一个分支后，如果没有break就会继续向下执行，遇到break才会跳出switch语句</p>
</li><li class=" "><p   
>default语句与位置无关，但是当default写在其他条件的前面时。如果没有break就会向下继续匹配执行</p>
</li></ol><p   
><strong class=" ">switch语句与if..else语句的区别：</strong></p>
<ol class=" "><li class=" "><p   
>switch语句只能进行等值判断（仅能支持常量表达式），而if..else可以进行区间判断（表达式、常量...都可以）</p>
</li><li class=" "><p   
>switch语句的执行效率远远高于if..else，在分支条件比较多的情况下，这种趋势愈发明显</p>
</li></ol>    <div class="section section-3" id="src-12714021_safe-id-Q-ivreiogC1Td2l0Y2jor63lj6XkuLrku4DkuYjpq5jmlYg">
        <h3 class="heading "><span>Switch&#35821;&#21477;&#20026;&#20160;&#20040;&#39640;&#25928;</span></h3>
<p   
>之前说到switch语句的执行效率远远高于if..else，这是为什么？我们可以写一段代码通过反汇编来查看其在底层的具体实现：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> x = </code><code class="value">3</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">switch</code><code class="plain">(x)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">case</code><code class="plain"> </code><code class="value">1</code><code class="plain">:</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"A \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">case</code><code class="plain"> </code><code class="value">2</code><code class="plain">:</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"B \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">case</code><code class="plain"> </code><code class="value">3</code><code class="plain">:</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"C \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">case</code><code class="plain"> </code><code class="value">4</code><code class="plain">:</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"D \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">default</code><code class="plain">:</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"default \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>其反汇编代码为：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-22_0-40-17.png" alt="images/download/attachments/12714021/image2021-2-22_0-40-17.png" width="600"  />
    </p>
<p   
>如上反汇编代码我们可以看出switch在一开始就直接将变量x与3进行比较，ja指令则表示大于则跳转，但这变量x明显等于3，所以将值赋予edx，最后jmp跳到堆栈地址2*4+40d896（40d896+8），也就是0x40D89E对应的值：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-22_0-51-14.png" alt="images/download/attachments/12714021/image2021-2-22_0-51-14.png"  height="250" />
    </p>
<p   
>最终跳转到0x0040d80c，打印出了C。</p>
<p   
>那么我们再使用if...else来实现相同功能：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> x = </code><code class="value">3</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">if</code><code class="plain"> (x == </code><code class="value">1</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"A \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">} </code><code class="keyword">else</code><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (x == </code><code class="value">2</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"B \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">} </code><code class="keyword">else</code><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (x == </code><code class="value">3</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"C \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">} </code><code class="keyword">else</code><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (x == </code><code class="value">4</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"D \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">} </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"default \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>其反汇编代码为：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-22_0-43-25.png" alt="images/download/attachments/12714021/image2021-2-22_0-43-25.png" width="600"  />
    </p>
<p   
>可以看见其会一行一行的执行，而不像switch语句一样，直接可以跳转到对应的地址。</p>
<p   
>通过观察堆栈，我们可以发现switch的高明之处：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-22_0-53-37.png" alt="images/download/attachments/12714021/image2021-2-22_0-53-37.png" width="600"  />
    </p>
<p   
>其将case分支的执行地址都存入到了堆栈中，而后使用算法去寻找到对应要执行的地址（堆栈存储的地址），这套算法我们可以这样理解：</p>
<p   
>1.堆栈中会存在一个执行地址的内存表，其顺序是按照case后的常量大小排序的，最大的常量所在的分支执行地址最先压入表中；如下图所示我将代码顺序打乱后还是如此：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-22_1-14-30.png" alt="images/download/attachments/12714021/image2021-2-22_1-14-30.png" width="600"  />
    </p>
<p   
>2.根据内存表存储顺序，直接将传入的值减去1，然后*4（这里也是数据宽度4字节）+最后压入的堆栈地址。</p>
<p   
>了解完算法原理之后，我们需要了解一个概念：大表和小表；当生成的函数跳转地址表，每个成员有4个字节的时，我们称之为大表。</p>
<p   
><strong class=" ">注意</strong>：</p>
<ol class=" "><li class=" "><p   
>在case分支小于等于3个、case最大值和最小值差大于等于255时<strong class=" ">不存在大小表</strong></p>
</li><li class=" "><p   
>在case分支大于3个并且大表项空隙小于等于6个时<strong class=" ">只有大表没有小表</strong></p>
</li><li class=" "><p   
>在case分支大于3个且大表项空隙大于6个且case最大最小差值小于255时存在<strong class=" ">大表和小表</strong></p>
</li></ol><p   
><strong class=" ">最后</strong>：在一般情况下，我们通常会去使用if语句而不是switch，因为if语句在编程时更加得心应手，所以我们可以暂且忽视效率而去选择更加便利的编写方式。</p>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lvqrnjq_or63lj6U">
        <h1 class="heading "><span>&#24490;&#29615;&#35821;&#21477;</span></h1>
<p   
>在C语言中如何实现让某些语句按照一定的条件重复执行呢？比如：打印0-N的值，这里可以先使用goto语句：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"><code class="plain">#include &lt;windows.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> MyPrint(</code><code class="keyword">int</code><code class="plain"> x)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">B:</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d\n"</code><code class="plain">,i);</code></div>
<div class="line"><code class="plain">    i++;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain">(i&lt;=x)</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">goto</code><code class="plain"> B;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    MyPrint(</code><code class="value">1</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>调用MyPrint函数，传入1，即可打印0-1的值，使用goto需要定义标签，例如如上代码B就是一个标签，则代表当前的执行地址，goto则跳转到改标签对应的执行地址开始执行，在里面加入if进行判断即可实现循环效果。</p>
<p   
>除此之外我们可以使用while语句实现：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"><code class="plain">#include &lt;windows.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> MyPrint(</code><code class="keyword">int</code><code class="plain"> x)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain">(i&lt;=x)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"%d\n"</code><code class="plain">,i);</code></div>
<div class="line"><code class="plain">        i++;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    MyPrint(</code><code class="value">100</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>使用while语句要注意表达式中的变量要自增自减，来实现循环结束的效果，不然会出现死循环的情况。</p>
<p   
>循环语句有这几种：</p>
<ol class=" "><li class=" "><p   
>while 循环</p>
</li><li class=" "><p   
>do...while 循环</p>
</li><li class=" "><p   
>for 循环</p>
</li></ol>    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC13aGlsZeW-queOrw">
        <h2 class="heading "><span>while &#24490;&#29615;</span></h2>
<p   
>while 语句的语法格式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">while</code><code class="plain">(表达式)</code></div>
<div class="line"><code class="plain">    语句;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">while</code><code class="plain">(表达式)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    语句;</code></div>
<div class="line"><code class="plain">    语句;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>值得注意的是：这里的表达式最终结果只要是非0，都会进入循环，而<strong class=" ">表达式也不具备强制性，可以是任何形式，但需要一个最终结果给到循环语句即可</strong>：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-28_19-57-39.png" alt="images/download/attachments/12714021/image2021-2-28_19-57-39.png" width="600"  />
    </p>
<p   
>while语句就是当表达式为非0时执行循环体内的语句，使用不当则会造成死循环，例如：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a = </code><code class="value">10</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain">(i&lt;a){</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"%d \n"</code><code class="plain">, i);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>如上代码，我们的需求是输出0-10的数字，但由于这里<strong class=" ">变量i</strong>没有变化，导致表达式结果是永真，固会进入死循环，一直输出0：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-28_19-38-52.png" alt="images/download/attachments/12714021/image2021-2-28_19-38-52.png" width="600"  />
    </p>
<p   
>这里的根本原因就是<strong class=" ">变量i</strong>没有随着单次循环结束而去自增，我们可以在循环体内使用自增<strong class=" ">i++</strong>解决这一问题。</p>
<p   
>循环语句不具备特殊性，我们也可以在循环语句内嵌套分支语句，例如打印1-N之间所有的偶数：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">while</code><code class="plain">(i&lt;=a)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain">(i%</code><code class="value">2</code><code class="plain">==</code><code class="value">0</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"%d \n"</code><code class="plain">,i)</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    i++;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>当然除了嵌套分支语句也可以嵌套循环语句，具体怎么玩还是看你具体需求，例如我这段代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a = </code><code class="value">10</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> j = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain">(i&lt;=a)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">while</code><code class="plain">(j&lt;=a)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">if</code><code class="plain">(j==i)</code></div>
<div class="line"><code class="plain">            {</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"%d \n"</code><code class="plain">,j);</code></div>
<div class="line"><code class="plain">            j++;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        i++;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>当i&lt;=a进入第一层while循环，j&lt;=i进入第二层while循环，在这里进入第二层循环时实际上如果没有break，则会输出1遍0-10的数字，但实际上因为我们添加了break所以到最后只会输出0-9的数字：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-28_20-11-33.png" alt="images/download/attachments/12714021/image2021-2-28_20-11-33.png" width="600"  />
    </p>
<p   
>所以除了在switch中可以使用到break，可以在循环语句中使用到break，简单来说它在这里就是<strong class=" ">跳出一层循环</strong>。</p>
<p   
>除了break外，我们再来学习一个语句：continue，它的作用就是<strong class=" ">中断当前循环，直接进行下一次循环</strong>，这里我们使用打印偶数的例子改造一下变成<strong class=" ">打印奇数</strong>：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">while</code><code class="plain">(i&lt;=a)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain">(i%</code><code class="value">2</code><code class="plain">==</code><code class="value">0</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        i++;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">continue</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d \n"</code><code class="plain">, i);</code></div>
<div class="line"><code class="plain">    i++;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-28_20-19-1.png" alt="images/download/attachments/12714021/image2021-2-28_20-19-1.png"  height="250" />
    </p>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC1kby4uLndoaWxl5b6q546v">
        <h2 class="heading "><span>do...while &#24490;&#29615;</span></h2>
<p   
>do...while 语句的语法格式：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>do{</p>
<p   
>语句;</p>
<p   
>}while(表达式);</p>
        </div>
    </div>
<p   
>该循环语句又一个特点就是，即使表达式为0（不成立），也会执行依次循环体内的语句，举例说明：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">do</code><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"test"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code><code class="keyword">while</code><code class="plain">(</code><code class="value">1</code><code class="plain">==</code><code class="value">2</code><code class="plain">);</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-28_20-23-3.png" alt="images/download/attachments/12714021/image2021-2-28_20-23-3.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC1mb3Llvqrnjq8">
        <h2 class="heading "><span>for &#24490;&#29615;</span></h2>
<p   
>for 语句的语法格式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">for</code><code class="plain">(表达式1;表达式2;表达式3)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    语句; </code><code class="comments">// 需要执行的代码4</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>for循环语句的执行顺序是1243 &rarr; 243 &rarr; 243...循环结束直至表达式2不成立为止。</p>
<p   
>我们之前也说到表达式是没有限制的，最终你只需要给一个结果到循环语句即可（<strong class=" ">决定循环语句是否循环执行的是表达式2，所以在这最终只需要将结果给到表达式2，其余可以不需要</strong>），所以for循环语句我们可以这样写：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> T1()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"T1 \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> T2()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"T2 \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"><code class="keyword">void</code><code class="plain"> T3()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"T3 \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"><code class="keyword">void</code><code class="plain"> T4()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"T4 \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(T1();T2();T3())</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        T4();</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-28_20-28-48.png" alt="images/download/attachments/12714021/image2021-2-28_20-28-48.png" width="700"  />
    </p>
<p   
>另外值得注意的是，for语句中的表达式是可以省略的：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">for</code><code class="plain">(;;)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"默认成立\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"><code class="keyword">for</code><code class="plain">(;-</code><code class="value">1</code><code class="plain">;)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"不是0就成立\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"><code class="keyword">for</code><code class="plain">(;</code><code class="value">0</code><code class="plain">;)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"不成立\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>除了这个以外表达式1和表达式3可以使用逗号分隔，写入多个语句：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> i;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> j;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> z;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">for</code><code class="plain">(i=</code><code class="value">0</code><code class="plain">,j=</code><code class="value">0</code><code class="plain">,z=</code><code class="value">0</code><code class="plain">;i&lt;</code><code class="value">10</code><code class="plain">;i++,j++,z++){</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d %d %d \n"</code><code class="plain">,i,j,z);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3lvqrnjq_or63lj6XnmoTlj43msYfnvJY">
        <h2 class="heading "><span>&#24490;&#29615;&#35821;&#21477;&#30340;&#21453;&#27719;&#32534;</span></h2>
<p   
>如下图是各个循环语句的反汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-28_20-35-21.png" alt="images/download/attachments/12714021/image2021-2-28_20-35-21.png" width="800"  />
    </p>
<p   
>但从汇编来看我们可以看得出do...while循环语句效率是最高的，但是在日常使用来说大部分会选择使用for与while，do...while出现的较少，还是跟之前我们说的一样，这一点空间可以忽视不管，for语句是最方便书写的，也就是我们可以用空间换编写效率。</p>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mlbDnu4Q">
        <h1 class="heading "><span>&#25968;&#32452;</span></h1>
<p   
>数组是C语言中非常重要的一个概念，学习C语言主要就是两个知识点：数组、指针，学好这两个，那么你的C语言一定也会很好。</p>
<p   
>什么是数组？或者说什么情况下我们需要使用数组，比如说我们需要定义一个人的年龄，我们可以定义一个变量来表示，但是如果我们需要定义三个人的年龄呢？那就需要三个变量来表示，这样很复杂，那么我们是否可以使用一个变量来存储三个人的年龄呢？这时候我们就需要使用数组来定义。</p>
<p   
>数组的定义格式如下：</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>数据类型 变量名[常量];</p>
        </div>
    </div>
<p   
>在方括号中我们只能选择使用常量，而不可以选择变量，这是因为在声明的时候编译器需要提前知道数组的长度，然后才会去分配对应大小的内存；那么也就说明此处的常量是用来表示数组可存储的个数。</p>
<p   
>这里我们以之前的例子，定义一个数组来表示：张三、李四、王五的年龄：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> age[</code><code class="value">3</code><code class="plain">] = {</code><code class="value">20</code><code class="plain">,</code><code class="value">18</code><code class="plain">,</code><code class="value">39</code><code class="plain">};</code></div>
</div>
    </div>
<p   
>除该方式外，我们还可以使用如下这种方式定义：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> age[] = {</code><code class="value">20</code><code class="plain">,</code><code class="value">18</code><code class="plain">,</code><code class="value">39</code><code class="plain">};</code></div>
</div>
    </div>
<p   
>我们可以简单看下反汇编，观察数组在汇编中是如何体现的：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-6_14-43-17.png" alt="images/download/attachments/12714021/image2021-3-6_14-43-17.png" width="500"  />
    </p>
<p   
>通过反汇编，我们可以看到数组就是整体连续存储进入堆栈中，从左到右依次进入。</p>
<p   
>那么数组在内存中是如何分配的呢？在之前我们学习过很多数据类型，在这里我们以char类型举例：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-2-17_23-18-7.png" alt="images/download/attachments/12714021/image2021-2-17_23-18-7.png" width="500"  />
    </p>
<p   
>可以看见char类型在分配内存空间时，都是以4字节空间分配的，这是因为在32位操作系统中，char类型分配的空间与int类型是一样的。</p>
<p   
>这个概念实际上就是<strong class=" ">本机宽度</strong>，本机是32位操作系统也就是4字节，在32位操作系统中处理4字节数据时速度最快，这也就出现了需要字节对齐（4字节）的情况。</p>
<p   
>这里我们再来看下char、short、int类型的数组的空间具体是如何分配的：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> a[</code><code class="value">10</code><code class="plain">]; </code><code class="comments">// char占用一个字节，需要10个字节，但是因为4字节对齐，所以分配的就是12个字节</code></div>
<div class="line"><code class="keyword">short</code><code class="plain"> b[</code><code class="value">10</code><code class="plain">]; </code><code class="comments">// short占用两个字节，需要20个字节，20个字节正好符合4字节对齐，所以分配的就是20个字节</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> c[</code><code class="value">10</code><code class="plain">]; </code><code class="comments">// int占用4个字节，需要40个字节，40个字节正好符合4字节对齐，所以分配的就是40个字节</code></div>
</div>
    </div>
<p   
>接下来我们学习一下如何存入、读取数组的数据（方括号[]内由0开始）：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> age[</code><code class="value">3</code><code class="plain">] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 读取</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> a = age[</code><code class="value">0</code><code class="plain">];</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> b = age[</code><code class="value">1</code><code class="plain">];</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 赋值（存入）</code></div>
<div class="line"><code class="plain">age[</code><code class="value">1</code><code class="plain">] = </code><code class="value">6</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 注意：在使用数组时，方括号[]中的内容可以使用表达式，而并非强制要求为常量。</code></div>
</div>
    </div>
<p   
>思考在数组数据读时候，可以越界读取使用么？如果可以结果是什么？我们可以做个小实验：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> arr[</code><code class="value">10</code><code class="plain">];</code></div>
<div class="line"><code class="plain">arr[</code><code class="value">10</code><code class="plain">] = </code><code class="value">100</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>如上代码我们来运行则会出现这种错误：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-8_9-19-29.png" alt="images/download/attachments/12714021/image2021-3-8_9-19-29.png" width="600"  />
    </p>
<p   
>也就是说当我们使用越界读取时会去读取一个不存在的未知地址。</p>
<p   
></p>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3or77lpJbvvJrnvJPlhrLljLrmuqLlh7o">
        <h2 class="heading "><span>&#35838;&#22806;&#65306;&#32531;&#20914;&#21306;&#28322;&#20986;</span></h2>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> Fun()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain">(</code><code class="value">1</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"why?\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> arr[</code><code class="value">8</code><code class="plain">];</code></div>
<div class="line"><code class="plain">    arr[</code><code class="value">9</code><code class="plain">] = (</code><code class="keyword">int</code><code class="plain">)&amp;Fun;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>如上代码中Fun函数为什么会被调用？我们可以通过反汇编代码+堆栈图来理解：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-8_9-33-45.png" alt="images/download/attachments/12714021/image2021-3-8_9-33-45.png" width="600"  />
    </p>
<p   
>堆栈图如下：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-8_9-31-56.png" alt="images/download/attachments/12714021/image2021-3-8_9-31-56.png" width="600"  />
    </p>
<p   
>经过观察我们发现，这里的数组越界访问，造成了堆栈中返回地址被篡改为Fun函数的地址，一旦执行到ret指令后，程序将会跳转到Fun函数然后往下执行，也就进入了死循环输出。</p>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lpJrnu7TmlbDnu4Q">
        <h1 class="heading "><span>&#22810;&#32500;&#25968;&#32452;</span></h1>
<p   
>多维数组是什么？假设我们现在需要定义一个班级有2个组，每个组有2个人，数组可以这样定义：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> arr[</code><code class="value">4</code><code class="plain">] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">};</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> arr1[</code><code class="value">2</code><code class="plain">*</code><code class="value">2</code><code class="plain">] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">};</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> arr2[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">] = {{</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">},{</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">}};</code></div>
</div>
    </div>
<p   
>一共有三种方式，最后一种的表示我们就称之为多维数组，我们之前所学的数组我们可以称之为一维数组；为什么会使用到多维数组？</p>
<p   
>如上图代码所示，我们想要知道第二组的第二个人，可以这样调用：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">arr[</code><code class="value">3</code><code class="plain">];</code></div>
<div class="line"><code class="plain">arr1[</code><code class="value">3</code><code class="plain">]</code></div>
<div class="line"><code class="plain">arr2[</code><code class="value">1</code><code class="plain">][</code><code class="value">1</code><code class="plain">];</code></div>
</div>
    </div>
<p   
>可以很明显的看见，当我们使用一维数组去调用的时候要通过计算的方法去思考，但是使用多维数组（<strong class=" ">这里有两个方括号所以称之为二维数组</strong>）我们完全没有这种烦恼，可以很方便的去调用。</p>
<p   
>那么以上所示的多维数组在内存中的分布是怎么样的呢？我们可以通过反汇编来看一下：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-10_22-47-54.png" alt="images/download/attachments/12714021/image2021-3-10_22-47-54.png" width="600"  />
    </p>
<p   
>如上图所示我们可以清晰的看见多维数组在内存中的分布是怎么样的，跟一维数组存储一点区别都没有。</p>
<p   
>所以也可以得出一个结论就是<strong class=" ">int arr[2*2];等价于int arr[2][2];</strong></p>
<p   
>多维数组的读写也很容易理解，举例说明一年有12个月，每个月都有一个平均气温，存储5年的数据：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> arr[</code><code class="value">5</code><code class="plain">][</code><code class="value">12</code><code class="plain">] = {</code></div>
<div class="line"><code class="plain">    {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">}, </code><code class="comments">// 0</code></div>
<div class="line"><code class="plain">    {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">}, </code><code class="comments">// 1</code></div>
<div class="line"><code class="plain">    {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">}, </code><code class="comments">// 2</code></div>
<div class="line"><code class="plain">    {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">}, </code><code class="comments">// 3</code></div>
<div class="line"><code class="plain">    {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">}  </code><code class="comments">// 4</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>读取第一年五月份的数据，修改第二年三月份的数据，可以这样来操作：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">arr[</code><code class="value">0</code><code class="plain">][</code><code class="value">4</code><code class="plain">];</code></div>
<div class="line"><code class="plain">arr[</code><code class="value">1</code><code class="plain">][</code><code class="value">2</code><code class="plain">] = </code><code class="value">10</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>编译器是如何找到对应数据的呢？第一年五月份的数据 &rarr; <strong class=" ">arr[0*12+4];</strong></p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3nu5PmnoTkvZM">
        <h1 class="heading "><span>&#32467;&#26500;&#20307;</span></h1>
<p   
>思考一下：</p>
<p   
>当需要一个容器能够存储<strong class=" ">1个字节</strong>，你会怎么做？<strong class=" ">使用char</strong>。</p>
<p   
>当需要一个容器能够存储<strong class=" ">4个字节</strong>，你会怎么做？ <strong class=" ">使用int</strong>。</p>
<p   
>当需要一个容器能够存储<strong class=" ">100个2个字节</strong>的数据，你会怎么做？ 使用<strong class=" ">short arr[100]</strong>。</p>
<p   
>当需要一个容器能够存储<strong class=" ">5个数据，这5个数据中有1字节的，2字节的有10字节的</strong>...你会怎么做？</p>
<p   
>这时候我们就要学习一个新的概念叫做：结构体；结构体的定义如下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct 类型名{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 可以定义多种类型</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> b;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">short</code><code class="plain"> c;</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>那么结构体的特点是什么呢？</p>
<ol class=" "><li class=" "><p   
>char/int/数组 等类型是编译器已知类型，我们称之为内置类型；但结构体编译器并不认识，当我们使用的时候需要告诉编译器一声，我们也称之为自定义类型；</p>
</li><li class=" "><p   
>如上代码所示我们仅仅是告诉编译器，我们定义的类型是什么样的，这段代码本身并不会占用内存空间；</p>
</li><li class=" "><p   
>结构体声明的位置和变量一样，都存在全局和局部的属性；</p>
</li><li class=" "><p   
>结构体在定义的时候，除了本身以外可以使用任何类型。</p>
</li></ol><p   
>结构体类型变量的定义：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct stStudent</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> stucode;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> stuName[</code><code class="value">20</code><code class="plain">];</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> stuAge;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> stuSex;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">stStudent student = {</code><code class="value">101</code><code class="plain">,</code><code class="string">"张三"</code><code class="plain">,</code><code class="value">18</code><code class="plain">,</code><code class="string">'M'</code><code class="plain">};</code></div>
</div>
    </div>
<p   
>结构体类型变量的读写：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct stPoint</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> y;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">stPoint point = {</code><code class="value">10</code><code class="plain">,</code><code class="value">20</code><code class="plain">};</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> x;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> y;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// read</code></div>
<div class="line"><code class="plain">x = point.x;</code></div>
<div class="line"><code class="plain">y = point.y;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// write</code></div>
<div class="line"><code class="plain">point.x = </code><code class="value">100</code><code class="plain">;</code></div>
<div class="line"><code class="plain">point.y = </code><code class="value">200</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>定义结构体类型的时候，直接定义变量：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct stPoint</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> y;</code></div>
<div class="line"><code class="plain">}point1,point2,point3;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">point1.x = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">point1.y = </code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">point2.x = </code><code class="value">3</code><code class="plain">;</code></div>
<div class="line"><code class="plain">point2.y = </code><code class="value">4</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">point3.x = </code><code class="value">5</code><code class="plain">;</code></div>
<div class="line"><code class="plain">point3.y = </code><code class="value">6</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>如上代码所示，定义结构体时是分配内存的，因为不仅定义了新的类型，还定义了三个变量。</p>
<p   
>动手思考一下，如下代码是否可行？</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct stPoint</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> y;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">stPoint point = {</code><code class="value">10</code><code class="plain">,</code><code class="value">20</code><code class="plain">};</code></div>
<div class="line"><code class="plain">stPoint point2 = {</code><code class="value">11</code><code class="plain">,</code><code class="value">20</code><code class="plain">};</code></div>
<div class="line"><code class="plain">point = point2;</code></div>
</div>
    </div>
<p   
>简单看下反汇编，我们发现是可以的，因为这里结构体类型都是一样的，类型一样，自然可以赋值：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_9-7-32.png" alt="images/download/attachments/12714021/image2021-3-11_9-7-32.png" width="600"  />
    </p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lrZfoioLlr7npvZA">
        <h1 class="heading "><span>&#23383;&#33410;&#23545;&#40784;</span></h1>
<p   
>之前我们学习过本机宽度的概念，在32位操作系统中，当我们定义变量时，当其数据宽度小于4字节时，在编译的时候还是会以4字节的方式去存储，这是一种用空间换时间的策略，那么除了本机宽度，还有<strong class=" ">字节对齐</strong>也属于这一策略。</p>
<p   
>我们先使用一段代码来测试一下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> x;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> y;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    x = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    y = </code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>如上x、y两个全局变量，char类型数据宽度是一个字节，所以假设其内存地址是0x0，那么全局变量y的内存地址是0x1，这是我们的猜想，但实际并不是这样，通过反汇编来看一下：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_16-34-48.png" alt="images/download/attachments/12714021/image2021-3-11_16-34-48.png" width="600"  />
    </p>
<p   
>可以清晰的看见，这里的地址并不是连续的，35、36、37这三个字节是被浪费掉了，这是为什么呢？这就是我们所谓的字节对齐；细心的人会发现这里的地址实际上就是数据宽度的整数倍，例如0x38是十进制4的整数倍。</p>
<p   
><strong class=" ">字节对齐就是</strong>：一个变量占用N个字节，则该变量的起始地址必须是N的整数倍，即：起始地址 % N = 0；如果是结构体，那么结构体的起始地址则是其最宽的数据类型成员的整数倍；这种方式可以提升程序编译的效率。</p>
<p   
>例如如下代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct Test {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> b;</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>则该结构体的起始地址则是4的整数倍，因为其最宽的数据类型成员是a（int类型）。</p>
<p   
>当我们想要打印一个变量、结构体等等的数据宽度该怎么办？这里我们需要使用到一个关键词sizeof，其使用方法如下：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_16-50-43.png" alt="images/download/attachments/12714021/image2021-3-11_16-50-43.png"  height="250" />
    </p>
<p   
>我们可以以上面所示的结构体代码举例，来打印一下看看：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_16-54-20.png" alt="images/download/attachments/12714021/image2021-3-11_16-54-20.png" width="600"  />
    </p>
<p   
>结构是8，所以也印证了，我们说的结构体也是需要字节对齐的。</p>
<p   
>之前我们说了这种方式是空间换时间的策略，但是在一些场景下，我们可用的空间有限，这种空间浪费可能无法满足或者我们无法接受这种浪费，这种情况下我们可以使用如下的方式来改变这种对齐方式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#pragma pack(</code><code class="value">1</code><code class="plain">)</code></div>
<div class="line"><code class="plain">struct Test{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> b;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"><code class="plain">#pragma pack()</code></div>
</div>
    </div>
<p   
>如上代码是通过#pragma pack(1)来改变<strong class=" ">结构体成员</strong>的对齐方式，但是无法影响结构体本身。</p>
<p   
>#pragma pack(n)中的n用来设定变量以n字节对齐方式，可以设定的值包含：1、2、4、8，VC6编译器默认是8；所以我们可以使用如上这种方式来取消强制对齐。</p>
<p   
>我们来看一下这个结构体最终的宽度是多少：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#pragma pack(</code><code class="value">2</code><code class="plain">)</code></div>
<div class="line"><code class="plain">struct Test{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> b;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> c;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"><code class="plain">#pragma pack()</code></div>
</div>
    </div>
<p   
>它的内存分配是这样的：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_17-10-13.png" alt="images/download/attachments/12714021/image2021-3-11_17-10-13.png" width="400"  />
    </p>
<p   
>因为我们强制要求了以2字节的方式进行对齐，所以char类型虽然只占了一个字节，却需要分配2个地址，而<strong class=" ">结构体的宽度等于<u class=" ">    <span style="color: #003366;">
最    </span>
小值(对齐参数, 最大数据宽度)的倍数</u>。</strong></p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3nu5PmnoTkvZPmlbDnu4Q">
        <h1 class="heading "><span>&#32467;&#26500;&#20307;&#25968;&#32452;</span></h1>
<p   
>结构体和int、char等本质是没有区别的，所以结构体也有数组，结构体数组的定义如下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">类型 变量名[常量表达式];</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 定义结构体类型</code></div>
<div class="line"><code class="plain">struct stStudent</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> Age;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> Level;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 定义结构体变量</code></div>
<div class="line"><code class="plain">struct stStudent st;</code></div>
<div class="line"><code class="comments">// 定义结构体数组</code></div>
<div class="line"><code class="plain">struct stStudent arr[</code><code class="value">10</code><code class="plain">]; 或者 stStudent arr[</code><code class="value">10</code><code class="plain">];</code></div>
</div>
    </div>
<p   
>结构体数组初始化：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct stStudent {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> Age;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> Level;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">stStudent arr[</code><code class="value">5</code><code class="plain">] = {{</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">}, {</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">}, {</code><code class="value">2</code><code class="plain">,</code><code class="value">2</code><code class="plain">}, {</code><code class="value">3</code><code class="plain">,</code><code class="value">3</code><code class="plain">}, {</code><code class="value">4</code><code class="plain">,</code><code class="value">4</code><code class="plain">}};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">arr[</code><code class="value">0</code><code class="plain">].Age = </code><code class="value">100</code><code class="plain">;</code></div>
<div class="line"><code class="plain">arr[</code><code class="value">0</code><code class="plain">].Level = </code><code class="value">100</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>结构体成员的使用：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 结构体数组名[下标].成员名</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">arr[</code><code class="value">0</code><code class="plain">].Age = </code><code class="value">10</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> age = arr[</code><code class="value">0</code><code class="plain">].Age;</code></div>
</div>
    </div>
<p   
>字符串成员的处理：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct stStudent{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> Age;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> Name[</code><code class="value">0x20</code><code class="plain">];</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"><code class="plain">struct stStudent arr[</code><code class="value">3</code><code class="plain">] = {{</code><code class="value">0</code><code class="plain">,</code><code class="string">"张三"</code><code class="plain">},{</code><code class="value">1</code><code class="plain">,</code><code class="string">"李四"</code><code class="plain">},{</code><code class="value">2</code><code class="plain">,</code><code class="string">"王五"</code><code class="plain">}};</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 读</code></div>
<div class="line"><code class="keyword">char</code><code class="plain"> buffer[</code><code class="value">0x20</code><code class="plain">];</code></div>
<div class="line"><code class="plain">strcpy(buffer,arr[</code><code class="value">0</code><code class="plain">].Name);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 写</code></div>
<div class="line"><code class="plain">strcpy(arr[</code><code class="value">0</code><code class="plain">].Name,</code><code class="string">"王钢蛋"</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>strcpy是一个字符串处理函数，用于字符串拷贝，其参数是传入的是两个地址，就谁传给谁。</p>
<p   
>最后我们来看一下结构体数组的内存结构，如下代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct stStudent{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> Age;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> Name[</code><code class="value">0x20</code><code class="plain">];</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"><code class="plain">struct stStudent arr[</code><code class="value">3</code><code class="plain">] = {{</code><code class="value">0</code><code class="plain">,</code><code class="string">"张三"</code><code class="plain">},{</code><code class="value">1</code><code class="plain">,</code><code class="string">"李四"</code><code class="plain">},{</code><code class="value">2</code><code class="plain">,</code><code class="string">"王五"</code><code class="plain">}};</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = arr[</code><code class="value">0</code><code class="plain">].Age;</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_17-34-10.png" alt="images/download/attachments/12714021/image2021-3-11_17-34-10.png" width="800"  />
    </p>
<p   
>结构体 stStudent 的宽度为 8 + 32 = 40；我们观察到结构体数组在内存中是<strong class=" ">连续存储</strong>的。</p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mjIfpkojnsbvlnos">
        <h1 class="heading "><span>&#25351;&#38024;&#31867;&#22411;</span></h1>
<p   
>在C语言里面指针是一种数据类型，是给编译看的，也就是说指针与int、char、数组、结构体是平级的，都是一个类型。</p>
<p   
>带<strong class=" ">&quot;*&quot;号的变量我们称之为指针类型</strong>，例如：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain">* x;</code></div>
<div class="line"><code class="keyword">short</code><code class="plain">* y;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">* a;</code></div>
<div class="line"><code class="keyword">float</code><code class="plain">* b;</code></div>
<div class="line"><code class="plain">...</code></div>
</div>
    </div>
<p   
>任何类型都可以带这个符号，格式就是：<strong class=" ">类型* 名称；星号可以是多个</strong>。</p>
<p   
>指针变量的赋值格式如下：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_17-46-21.png" alt="images/download/attachments/12714021/image2021-3-11_17-46-21.png" width="600"  />
    </p>
<p   
>指针类型的变量宽度永远是4字节，无论类型是什么，无论有几个星号。</p>
<p   
>指针类型和其他数据类型是一样的，也可以做自增、自减，但与其他数据类型不一样的是，指针类型自增、自减是加、减<strong class=" ">去掉一个星号后的宽度</strong>。</p>
<p   
>如下代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain">** a;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain">** b;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    a = (</code><code class="keyword">int</code><code class="plain">**)</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    b = (</code><code class="keyword">char</code><code class="plain">**)</code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    a++;</code></div>
<div class="line"><code class="plain">    b++;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d %d \n"</code><code class="plain">, a, b);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>第一次自增，a+4 = 5，b+4 = 6，因为减去一个星号还是指针，指针的宽度永远是4：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_18-6-47.png" alt="images/download/attachments/12714021/image2021-3-11_18-6-47.png"  height="250" />
    </p>
<p   
>自减同理可得，那么我们知道了自增、自减就可以知道指针类型的加减运算规律：</p>
<p   
>因为自增、自减，本质上就是+1，所以我们可以得出算式：</p>
<p   
><strong class=" ">指针类型变量 + N = 指针类型变量 + N * (去掉一个*后类型的宽度)</strong></p>
<p   
><strong class=" ">指针类型变量 - N = 指针类型变量 - N * (去掉一个*后类型的宽度)</strong></p>
<p   
>但需要注意，指针类型无法做乘除运算。</p>
<p   
><strong class=" ">最后</strong>：指针类型是可以做比较的。</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_18-19-53.png" alt="images/download/attachments/12714021/image2021-3-11_18-19-53.png" width="600"  />
    </p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC0m55qE5L2_55So">
        <h1 class="heading "><span>&amp;&#30340;&#20351;&#29992;</span></h1>
<p   
>&amp;符号是取地址符，任何变量都可以使用&amp;来获取地址，但不能用在常量上。</p>
<p   
>如下代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">struct Point {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> y;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">char</code><code class="plain"> a;</code></div>
<div class="line"><code class="keyword">short</code><code class="plain"> b;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> c;</code></div>
<div class="line"><code class="plain">Point p;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%x %x %x %x \n"</code><code class="plain">, &amp;a, &amp;b, &amp;c, &amp;p);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_20-20-12.png" alt="images/download/attachments/12714021/image2021-3-11_20-20-12.png" width="600"  />
    </p>
<p   
>在这里使用取地址符可以直接获取每个变量、结构体的地址，但是这种格式可能跟我们之前看到的8位不一样，前面少了2个0，这时候可以将%x占位符替换为%p来打印显示。</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_20-28-26.png" alt="images/download/attachments/12714021/image2021-3-11_20-28-26.png" width="500"  />
    </p>
<p   
>那么取地址符（&amp;变量）的类型是什么呢？我们可以来探测下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> a;</code></div>
<div class="line"><code class="keyword">short</code><code class="plain">* b;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">** c;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = &amp;a;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = &amp;b;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = &amp;c;</code></div>
</div>
    </div>
<p   
>以上代码我们在编译的时候是没法成功的，它的报错内容是：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_20-32-32.png" alt="images/download/attachments/12714021/image2021-3-11_20-32-32.png" width="1000"  />
    </p>
<p   
>通过报错内容我们可以看出类型不同无法转换，但是我仔细观察报错内容：char*无法转换成int，short**无法转换成int...那么就说明了一点，在我们使用取地址符时，<strong class=" ">变量会在其原本的数据类型后加一个星号</strong>。</p>
<p   
>可以这样进行指针赋值：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> x;</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* p1;</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">** p2;</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">*** p3;</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">**** p4;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">p1 = &amp;x; </code><code class="comments">// &amp;x -&gt; char*</code></div>
<div class="line"><code class="plain">p2 = &amp;p1;</code></div>
<div class="line"><code class="plain">p3 = &amp;p2;</code></div>
<div class="line"><code class="plain">p4 = &amp;p3;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">p1 = (</code><code class="keyword">char</code><code class="plain">*)p4;</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lj5blgLzov5DnrpfnrKY">
        <h1 class="heading "><span>&#21462;&#20540;&#36816;&#31639;&#31526;</span></h1>
<p   
><strong class=" ">取值运算符就是我们之前所了解的&ldquo;*&rdquo;星号</strong>，&ldquo;*&rdquo;星号有这几个用途：</p>
<ol class=" "><li class=" "><p   
>乘法运算符（1*2）</p>
</li><li class=" "><p   
>定义新的类型（char*）</p>
</li><li class=" "><p   
>取值运算符（<strong class=" ">星号+指针类型的变量</strong>）；也就是取地址的存储的值。</p>
</li></ol><p   
>如下代码就是使用取值运算符：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain">* a = (</code><code class="keyword">int</code><code class="plain">*)</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%x \n"</code><code class="plain">, *a);</code></div>
</div>
    </div>
<p   
>这段代码可以编译，但是是无法运行的，我们可以运行一下然后来看看反汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_20-54-42.png" alt="images/download/attachments/12714021/image2021-3-11_20-54-42.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_20-55-56.png" alt="images/download/attachments/12714021/image2021-3-11_20-55-56.png" width="600"  />
    </p>
<p   
>如上反汇编代码，我们可以清楚的看见首先0x1给了局部变量（ebp-4），之后这个局部变量（ebp-4）给了eax，而后eax又作为了内存地址去寻找对应存储的值，但是这里eax为0x1，所以在内存中根本就不存在这个地址，也就没办法找到对应的值，自然就无法运行。</p>
<p   
>那么取值运算符（星号+指针类型）是什么类型呢？我们来探测下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain">*** a;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">**** b;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">***** c;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">* d;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = *(a);</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = *(b);</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = *(c);</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> x = *(d);</code></div>
</div>
    </div>
<p   
>以上代码我们在编译的时候是没法成功的，它的报错内容是：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_21-11-11.png" alt="images/download/attachments/12714021/image2021-3-11_21-11-11.png" width="1000"  />
    </p>
<p   
>通过报错内容我们可以看出类型不同无法转换，但是我仔细观察报错内容：int**无法转换成int，int***无法转换成int...那么就说明了一点，在我们使用取值运算符时，<strong class=" ">变量会在其原本的数据类型后减去一个星号</strong>。</p>
<p   
><strong class=" ">取值运算符举例</strong>：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> x = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">* p = &amp;x;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">** p2 = &amp;p;</code></div>
<div class="line"><code class="plain">*(p) = </code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">*** p3 = &amp;p2;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> r = *(*(*(p3)));</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mlbDnu4Tlj4LmlbDkvKDpgJI">
        <h1 class="heading "><span>&#25968;&#32452;&#21442;&#25968;&#20256;&#36882;</span></h1>
<p   
>之前我们学过几本类型的参数传递，如下代码所示：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> plus(</code><code class="keyword">int</code><code class="plain"> p) {</code></div>
<div class="line"><code class="plain">    p = p + </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    plus(x);</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d \n"</code><code class="plain">, x);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>如上代码变量x最终值是多少？相信很多人都知道答案了，是1，原封不动。</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_21-26-28.png" alt="images/download/attachments/12714021/image2021-3-11_21-26-28.png"  height="250" />
    </p>
<p   
>为什么是1？这是因为在变量x作为参数传入plus函数，是传入值而不是这个变量本身，所以并不会改变变量本身。</p>
<p   
>数组也是可以作为参数传递，我们想要传入一个数组，然后打印数组的值（<strong class=" ">定义数组参数时方括号中不要写入常量</strong>）：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> printArray(</code><code class="keyword">int</code><code class="plain"> arr[], </code><code class="keyword">int</code><code class="plain"> aLength) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain"> (</code><code class="keyword">int</code><code class="plain"> i=</code><code class="value">0</code><code class="plain">; i&lt;aLength; i++) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"%d \n"</code><code class="plain">, arr[i]);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> arr[] = {</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    printArray(arr, </code><code class="value">5</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>我们想打印数组不仅要知道数组是什么，也要获取数组的长度，所以需要两个参数（实际上我们也有其他方法获取长度，这里先不多说）。</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_21-34-18.png" alt="images/download/attachments/12714021/image2021-3-11_21-34-18.png" width="600"  />
    </p>
<p   
>我们来看下反汇编代码，看看数组是否和基本类型一样传入的是值：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_21-36-47.png" alt="images/download/attachments/12714021/image2021-3-11_21-36-47.png" width="600"  />
    </p>
<p   
>通过如上代码所示，我们可以很清晰的看见，ebp-14也就是数组的第一个值的地址给了eax，最后eax压入堆栈，也就是传递给了函数。</p>
<p   
>所以我们得出结论：<strong class=" ">数组参数传递时，传入的是数组第一个值的地址，而不是值；换而言之，我们在printArray函数中修改传入的数组，也就修改了数组本身</strong>。</p>
<p   
>我们再换个思路，在数组作为参数传递的时候，可以换一种形式，直接传入地址也是可以打印的，也就是使用指针来操作数组：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_21-42-23.png" alt="images/download/attachments/12714021/image2021-3-11_21-42-23.png" width="600"  />
    </p>
<p   
>事实证明这是可行的，我们在传入参数的时候使用数组第一个值的地址即可。</p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mjIfpkojkuI7lrZfnrKbkuLI">
        <h1 class="heading "><span>&#25351;&#38024;&#19982;&#23383;&#31526;&#20018;</span></h1>
<p   
>在学习完指针类型后，我们可以来了解一下这些函数：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> strlen(</code><code class="keyword">char</code><code class="plain">* s); </code><code class="comments">// 返回类型是字符串s的长度，不包含结束符号\0</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* strcpy(</code><code class="keyword">char</code><code class="plain">* dest, </code><code class="keyword">char</code><code class="plain">* src); </code><code class="comments">// 复制字符串src到dest中，返回指针为dest的值</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* strcat(</code><code class="keyword">char</code><code class="plain">* dest, </code><code class="keyword">char</code><code class="plain">* src); </code><code class="comments">// 将字符串src添加到dest尾部，返回指针为dest的值</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> strcmp(</code><code class="keyword">char</code><code class="plain">* s1, </code><code class="keyword">char</code><code class="plain">* s2); </code><code class="comments">// 比较s1和s2，一样则返回0，不一样返回非0</code></div>
</div>
    </div>
<p   
>字符串的几种表现形式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain"> str[</code><code class="value">6</code><code class="plain">] = {</code><code class="string">'A'</code><code class="plain">,</code><code class="string">'B'</code><code class="plain">,</code><code class="string">'C'</code><code class="plain">,</code><code class="string">'D'</code><code class="plain">,</code><code class="string">'E'</code><code class="plain">,</code><code class="string">'F'</code><code class="plain">};</code></div>
<div class="line"><code class="keyword">char</code><code class="plain"> str[] = </code><code class="string">"ABCDE"</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* str = </code><code class="string">"ABCDE"</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>指针函数（本质就是函数，只不过函数的返回类型是某一类型的指针）：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain">* strcpy(</code><code class="keyword">char</code><code class="plain">* dest, </code><code class="keyword">char</code><code class="plain">* src);</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* strcat(</code><code class="keyword">char</code><code class="plain">* dest, </code><code class="keyword">char</code><code class="plain">* src);</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mjIfpkojlj5blgLznmoTkuKTnp43mlrnlvI8">
        <h1 class="heading "><span>&#25351;&#38024;&#21462;&#20540;&#30340;&#20004;&#31181;&#26041;&#24335;</span></h1>
<p   
>如下图所示的则是一级指针（一个星号）和多级指针（多个星号）：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_21-53-1.png" alt="images/download/attachments/12714021/image2021-3-11_21-53-1.png" width="500"  />
    </p>
<p   
>这段代码看着很复杂，但我们有基础后再看它轻而易举，脑子里浮现的就是汇编代码。</p>
<p   
>指针取值有两种方式，如下代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain">* p = (</code><code class="keyword">int</code><code class="plain">*)</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d %d"</code><code class="plain">, *(p), p[</code><code class="value">0</code><code class="plain">]);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>我们可以使用取值运算符，也可以使用数组的方式，因为其本质都是一样的，我们来看下反汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_21-58-55.png" alt="images/download/attachments/12714021/image2021-3-11_21-58-55.png"  height="250" />
    </p>
<p   
>也就说明：*()与[]的互换，如下是互换的一些例子：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain">* p = (</code><code class="keyword">int</code><code class="plain">*)</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d \n"</code><code class="plain">,p[</code><code class="value">0</code><code class="plain">],*p);  </code><code class="comments">//p[0] = *(p+0) = *p  </code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain">** p = (</code><code class="keyword">int</code><code class="plain">**)</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d \n"</code><code class="plain">,p[</code><code class="value">0</code><code class="plain">][</code><code class="value">0</code><code class="plain">],**p);  </code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d \n"</code><code class="plain">,p[</code><code class="value">1</code><code class="plain">][</code><code class="value">2</code><code class="plain">],*(*(p+</code><code class="value">1</code><code class="plain">)+</code><code class="value">2</code><code class="plain">));</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain">*** p = (</code><code class="keyword">int</code><code class="plain">***)</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d \n"</code><code class="plain">,p[</code><code class="value">1</code><code class="plain">][</code><code class="value">2</code><code class="plain">][</code><code class="value">3</code><code class="plain">],*(*(*(p+</code><code class="value">1</code><code class="plain">)+</code><code class="value">2</code><code class="plain">)+</code><code class="value">3</code><code class="plain">));  </code></div>
<div class="line"> </div>
<div class="line"><code class="comments">/*</code></div>
<div class="line"><code class="comments">*(*(*(*(*(*(*(p7))))))))</code></div>
<div class="line"><code class="comments">= *(*(*(*(*(*(p7+0)+0)+0)+0)+0)+0)</code></div>
<div class="line"><code class="comments">= p7[0][0][0][0][0][0][0]</code></div>
<div class="line"><code class="comments">*/</code></div>
</div>
    </div>
<p   
>总结：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">*(p+i) = p[i]  </code></div>
<div class="line"><code class="plain">*(*(p+i)+k) = p[i][k]  </code></div>
<div class="line"><code class="plain">*(*(*(p+i)+k)+m) = p[i][k][m]  </code></div>
<div class="line"><code class="plain">*(*(*(*(*(p+i)+k)+m)+w)+t) = p[i][k][m][w][t]  </code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3nu5PmnoTkvZPmjIfpkog">
        <h1 class="heading "><span>&#32467;&#26500;&#20307;&#25351;&#38024;</span></h1>
<p   
>我们来了解一下结构体指针，如下代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">struct Point {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> b;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    Point p;</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    Point* px = &amp;p;</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d \n"</code><code class="plain">, sizeof(px));</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>我们打印结构体指针的宽度，最终结果是4，这时候我们需要知道不论你是什么类型的指针，其特性就是我们之前说的指针的特性，并不会改变。</p>
<p   
>如下代码就是使用结构体指针：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 创建结构体</code></div>
<div class="line"><code class="plain">Point p;</code></div>
<div class="line"><code class="plain">p.x=</code><code class="value">10</code><code class="plain">;</code></div>
<div class="line"><code class="plain">p.y=</code><code class="value">20</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 声明结构体指针</code></div>
<div class="line"><code class="plain">Point* ps;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 为结构体指针赋值</code></div>
<div class="line"><code class="plain">ps = &amp;p;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 通过指针读取数据</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d \n"</code><code class="plain">,ps-&gt;x);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 通过指针修改数据</code></div>
<div class="line"><code class="plain">ps-&gt;y=</code><code class="value">100</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d\n"</code><code class="plain">,ps-&gt;y);</code></div>
</div>
    </div>
<p   
>提问：结构体指针一定要指向结构体吗？如下代码就是最好的解释：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">struct Point</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> y;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> arr[</code><code class="value">10</code><code class="plain">] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">10</code><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    Point* p = (Point*)arr;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x = p-&gt;x;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> y = p-&gt;y;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d %d \n"</code><code class="plain">, x, y);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_22-17-45.png" alt="images/download/attachments/12714021/image2021-3-11_22-17-45.png" width="600"  />
    </p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3mjIfpkojmlbDnu4TkuI7mlbDnu4TmjIfpkog">
        <h1 class="heading "><span>&#25351;&#38024;&#25968;&#32452;&#19982;&#25968;&#32452;&#25351;&#38024;</span></h1>
<p   
>指针数组和数组指针，这两个是完全不一样的东西，指针数组的定义：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain">* arr[</code><code class="value">10</code><code class="plain">];</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">Point* arr[</code><code class="value">10</code><code class="plain">];</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain">********** arr[</code><code class="value">10</code><code class="plain">];</code></div>
</div>
    </div>
<p   
>指针数组的赋值方式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">char</code><code class="plain">* a = </code><code class="string">"Hello"</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* b = </code><code class="string">"World"</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// one</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* arr[</code><code class="value">2</code><code class="plain">] = {a, b};</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// two</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* arr1[</code><code class="value">2</code><code class="plain">];</code></div>
<div class="line"><code class="plain">arr1[</code><code class="value">0</code><code class="plain">] = a;</code></div>
<div class="line"><code class="plain">arr1[</code><code class="value">1</code><code class="plain">] = b;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// three</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">* arr2[</code><code class="value">2</code><code class="plain">] = {</code><code class="string">"Hello"</code><code class="plain">, </code><code class="string">"World"</code><code class="plain">};</code></div>
</div>
    </div>
<p   
>一共有三种赋值方式，在实际应用中我们更偏向于第三种方式。</p>
<p   
>结构体指针也有数组，我们可以看下其定义和对应宽度：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_22-26-54.png" alt="images/download/attachments/12714021/image2021-3-11_22-26-54.png" width="400"  />
    </p>
<p   
>接下来我们要学习的是数组指针，数组指针在实际应用很少用到，数组指针是最难学的。</p>
<p   
>首先分析一下如下代码：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> arr[] = {</code><code class="value">1</code><code class="plain">, </code><code class="value">2</code><code class="plain">, </code><code class="value">3</code><code class="plain">, </code><code class="value">4</code><code class="plain">, </code><code class="value">5</code><code class="plain">, </code><code class="value">6</code><code class="plain">, </code><code class="value">7</code><code class="plain">, </code><code class="value">8</code><code class="plain">, </code><code class="value">9</code><code class="plain">, </code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">* p = &amp;arr[</code><code class="value">0</code><code class="plain">];</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">* p = arr; </code><code class="comments">// &amp;arr[0] </code></div>
<div class="line"><code class="keyword">int</code><code class="plain">* p = (</code><code class="keyword">int</code><code class="plain"> *)&amp;arr; </code><code class="comments">// &amp;arr -&gt; int *[10]</code></div>
</div>
    </div>
<p   
>&amp;arr就是我们要学的数组指针，也就是int *[10]，数组指针的定义如下：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain">(*px)[</code><code class="value">5</code><code class="plain">]; </code><code class="comments">// 一维数组指针</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">(*px)[</code><code class="value">3</code><code class="plain">];</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">(*px)[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">]; </code><code class="comments">// 二维数组指针</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">(*px)[</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">]; </code><code class="comments">// 三维数组指针</code></div>
</div>
    </div>
<p   
>px就是我们随便定义的名字，本质上就是指针，那么也就有着指针的特性，无论是长度还是加减法...</p>
<p   
>思考：int *p[5] 与 int(*p)[5]有什么区别？我们可以来看看宽度：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_22-42-13.png" alt="images/download/attachments/12714021/image2021-3-11_22-42-13.png" width="600"  />
    </p>
<p   
>可以看见一个是20，一个是4；一个是指针变量的数组，一个是数组指针，本质是不一样的。</p>
<p   
>数组指针的宽度和赋值：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain">(*px1)p[</code><code class="value">5</code><code class="plain">];</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">(*px2)[</code><code class="value">3</code><code class="plain">];      </code></div>
<div class="line"><code class="keyword">int</code><code class="plain">(*px3)[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">];</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">(*px4)[</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">];</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d %d %d\n"</code><code class="plain">,sizeof(px1),sizeof(px2),sizeof(px3),sizeof(px4));</code></div>
<div class="line"><code class="comments">// 4 4 4 4 </code></div>
<div class="line"><code class="plain">px1 = (</code><code class="keyword">int</code><code class="plain"> (*)[</code><code class="value">5</code><code class="plain">])</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">px2 = (</code><code class="keyword">char</code><code class="plain"> (*)[</code><code class="value">3</code><code class="plain">])</code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"><code class="plain">px3 = (</code><code class="keyword">int</code><code class="plain"> (*)[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">])</code><code class="value">3</code><code class="plain">;</code></div>
<div class="line"><code class="plain">px4 = (</code><code class="keyword">char</code><code class="plain"> (*)[</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">])</code><code class="value">4</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>数组指针的运算：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain">(*px1)p[</code><code class="value">5</code><code class="plain">];</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">(*px2)[</code><code class="value">3</code><code class="plain">];      </code></div>
<div class="line"><code class="keyword">int</code><code class="plain">(*px3)[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">];</code></div>
<div class="line"><code class="keyword">char</code><code class="plain">(*px4)[</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">];</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">px1 = (</code><code class="keyword">int</code><code class="plain"> (*)[</code><code class="value">5</code><code class="plain">])</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">px2 = (</code><code class="keyword">char</code><code class="plain"> (*)[</code><code class="value">3</code><code class="plain">])</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">px3 = (</code><code class="keyword">int</code><code class="plain"> (*)[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">])</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">px4 = (</code><code class="keyword">char</code><code class="plain"> (*)[</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">])</code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">px1++;  </code><code class="comments">//int(4) *5  +20 =21</code></div>
<div class="line"><code class="plain">px2++;  </code><code class="comments">//char(1) *3   +3 =4</code></div>
<div class="line"><code class="plain">px3++;  </code><code class="comments">//int(4) *2 *2  +16 =17</code></div>
<div class="line"><code class="plain">px4++;  </code><code class="comments">//char(1) *3 *3 *3 +9 =10</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d %d %d \n"</code><code class="plain">,px1,px2,px3,px4);</code></div>
</div>
    </div>
<p   
>数组指针的使用：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 第一种：</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> arr[] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">(*px)[</code><code class="value">10</code><code class="plain">] = &amp;arr;</code></div>
<div class="line"><code class="comments">// *px 是啥类型？  int[10] 数组类型</code></div>
<div class="line"><code class="comments">// px[0] 等价于 *px 所以 *px 也等于 int[10]数组</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d \n"</code><code class="plain">,(*px)[</code><code class="value">0</code><code class="plain">],px[</code><code class="value">0</code><code class="plain">][</code><code class="value">0</code><code class="plain">]);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">px++; </code><code class="comments">// 后 (*px)[0]就访问整个数组地址后的地址内的数据</code></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><code class="comments">// 第二种：</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> arr[</code><code class="value">3</code><code class="plain">][</code><code class="value">3</code><code class="plain">] = {</code></div>
<div class="line"><code class="plain">    {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">},</code></div>
<div class="line"><code class="plain">    {</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">},</code></div>
<div class="line"><code class="plain">    {</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">}</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 此时的 px指针 指向的 {1,2,3}这个数组的首地址</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">(*px)[</code><code class="value">3</code><code class="plain">] = &amp;arr[</code><code class="value">0</code><code class="plain">];</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">//  *px -&gt; 此时就是数组{1,2,3}本身</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 越过第一个数组 此时px指针指向 {4，5，6}的首地址</code></div>
<div class="line"><code class="plain">px++;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">printf(</code><code class="string">"%d %d \n"</code><code class="plain">,(*px)[</code><code class="value">0</code><code class="plain">],px[</code><code class="value">0</code><code class="plain">][</code><code class="value">0</code><code class="plain">]);</code></div>
<div class="line"><code class="comments">// 这里打印的就是 4 4</code></div>
</div>
    </div>
<p   
>思考：二维数组指针可以访问一维数组吗？</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> arr[] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="keyword">int</code><code class="plain">(*px)[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">] = (</code><code class="keyword">int</code><code class="plain">(*)[</code><code class="value">2</code><code class="plain">][</code><code class="value">2</code><code class="plain">])arr;</code></div>
</div>
    </div>
<p   
>是可以的，因为*px实际上就是int[2][2]，我们之前学过多维数组，int[2][2]也就等于int[4]，所以{1,2,3,4}就给了int[2][2]，也就是{{1,2}, {3,4}}，所以(*px)[1][1]为4。</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_22-56-38.png" alt="images/download/attachments/12714021/image2021-3-11_22-56-38.png" width="600"  />
    </p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3osIPnlKjnuqblrpo">
        <h1 class="heading "><span>&#35843;&#29992;&#32422;&#23450;</span></h1>
<p   
>函数调用约定就是告诉编译器怎么传递参数，怎么传递返回值，怎么平衡堆栈。</p>
<p   
>常见的几种调用约定:</p>
    <div  class="tablewrap">
        <table class="relative-table wrapped confluenceTable">
                    <colgroup>
                                    <col  width="15.9923%"/>
                                    <col  width="60.8863%"/>
                                    <col  width="23.1214%"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>调用约定</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>参数压栈顺序</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>平衡堆栈</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>__cdecl</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>从右至左入栈</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>调用者清理栈</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>__stdcall</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>从右至左入栈</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>自身清理堆栈</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>__fastcall</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>ECX/EDX 传送前两个，剩下：从右至左入栈</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>自身清理堆栈</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>一般情况下自带库默认使用 __stdcall，我们写的代码默认使用 __cdecl，更换调用约定就是在函数名称前面加上关键词：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> __stdcall method(</code><code class="keyword">int</code><code class="plain"> x,</code><code class="keyword">int</code><code class="plain"> y)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> x+y;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">method(</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">);</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3lh73mlbDmjIfpkog">
        <h1 class="heading "><span>&#20989;&#25968;&#25351;&#38024;</span></h1>
<p   
>函数指针变量定义的格式：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 返回类型 (调用约定 *变量名)(参数列表);</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> (__cdecl *pFun)(</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>函数指针类型变量的赋值与使用：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 定义函数指针变量</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> (__cdecl *pFun)(</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">);</code></div>
<div class="line"><code class="comments">// 为函数指针变量赋值</code></div>
<div class="line"><code class="plain">pFun = (</code><code class="keyword">int</code><code class="plain"> (__cdecl *)(</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">))</code><code class="value">10</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 使用函数指针变量</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> r = pFun(</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>我们来看下函数指针的反汇编代码：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_23-5-37.png" alt="images/download/attachments/12714021/image2021-3-11_23-5-37.png" width="500"  />
    </p>
<p   
>可以很清晰的看见函数指针生成来一堆汇编代码，传参、调用、以及如何平衡堆栈；而如上这段代码最终会调用地址0xA，但它本身不存在，所以无法运行。</p>
<p   
>所以我们想要调用某个函数时可以将地址赋值给pFun即可，并且在定义时写好对应的参数列表即可；也就是说函数指针通常用来使用别人写好的函数。</p>
<p   
>我们也通过函数指针绕过调试器断点，假设有攻击者要破解你的程序，它在MessageBox下断点，你正常的代码就会被成功断点，但是如果你使用函数指针的方式就可以绕过。</p>
<p   
>首先，我们先写一段正常的MessageBox程序，然后使用DTDebug来下断点：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_23-29-48.png" alt="images/download/attachments/12714021/image2021-3-11_23-29-48.png" width="700"  />
    </p>
<p   
>可以看见，我们下断点成功断下来了，断点本质上就是在MOV EDI, EDI所在那行的地址下断点，那么我们可以直接跳过这行调用调用下一行，实际上这段汇编的核心在于我标记的部分，准确一点的说就是CALL指令哪一行，我们可以右键Follo跟进：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_23-49-11.png" alt="images/download/attachments/12714021/image2021-3-11_23-49-11.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_23-50-10.png" alt="images/download/attachments/12714021/image2021-3-11_23-50-10.png" width="600"  />
    </p>
<p   
>我们可以从0x77D5057D开始执行，通过汇编代码可以知道这个函数需要5个参数，并且最后的RETN则表示内平栈则使用__stdcall，所以我们函数指针（操作系统API返回通常是4字节）可以这样写：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;windows.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> (__stdcall *pFun)(</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    pFun = (</code><code class="keyword">int</code><code class="plain"> (__stdcall *)(</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">,</code><code class="keyword">int</code><code class="plain">))</code><code class="value">0x77D5057D</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    MessageBox(</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    pFun(</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>这样就可以绕过断点了：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-11_23-52-19.png" alt="images/download/attachments/12714021/image2021-3-11_23-52-19.png" width="800"  />
    </p>
<p   
></p>
    </div>
    <div class="section section-1" id="src-12714021_safe-id-Q-ivreiogC3pooTlpITnkIbkuYvlro_lrprkuYnjgIHmnaHku7bnvJbor5HkuI7mlofku7bljIXlkKs">
        <h1 class="heading "><span>&#39044;&#22788;&#29702;&#20043;&#23439;&#23450;&#20041;&#12289;&#26465;&#20214;&#32534;&#35793;&#19982;&#25991;&#20214;&#21253;&#21547;</span></h1>
<p   
>预处理一般是指在程序源代码被转换为二进制代码之前，由预处理器对程序源代码文本进行处理，处理后的结果再由编译器进一步编译。</p>
<p   
>预处理功能主要包括宏定义、文件包含、条件编译三部分。</p>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3lro_lrprkuYk">
        <h2 class="heading "><span>&#23439;&#23450;&#20041;</span></h2>
<p   
>简单的宏：<strong class=" ">#define 标识符 字符序列</strong></p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define FALSE </code><code class="value">0</code></div>
<div class="line"><code class="plain">#define NAME </code><code class="string">"LUODAOYI"</code></div>
<div class="line"><code class="plain">#define __IN</code></div>
<div class="line"><code class="plain">#define __OUT</code></div>
</div>
    </div>
<p   
>极端例子：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define NAME </code><code class="string">"LUODAOYI"</code></div>
<div class="line"><code class="plain">#define A </code><code class="keyword">int</code><code class="plain"> method() {</code></div>
<div class="line"><code class="plain">#define B </code><code class="keyword">char</code><code class="plain"> buffer[</code><code class="value">0x10</code><code class="plain">];</code></div>
<div class="line"><code class="plain">#define C strcpy(buffer,NAME);</code></div>
<div class="line"><code class="plain">#define D </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;}</code></div>
<div class="line"><code class="plain">#define E method();</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// use</code></div>
<div class="line"><code class="plain">A</code></div>
<div class="line"><code class="plain">B</code></div>
<div class="line"><code class="plain">C</code></div>
<div class="line"><code class="plain">D</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    E</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>带参数的宏：<strong class=" ">#define 标识符(参数表) 字符序列</strong></p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define MAX(A,B)((A)&gt;(B)?(A):(B))</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> method()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> x = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> y = </code><code class="value">2</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> z = MAX(x,y);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>多行定义，'\' 后不可有空格</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define A </code><code class="keyword">for</code><code class="plain">(</code><code class="keyword">int</code><code class="plain"> i=</code><code class="value">0</code><code class="plain">;i&lt;length;i++)\</code></div>
<div class="line"><code class="plain">{\</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d \n"</code><code class="plain">,arr[i]);\</code></div>
<div class="line"><code class="plain">}\</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> method(</code><code class="keyword">int</code><code class="plain"> arr[],</code><code class="keyword">int</code><code class="plain"> length)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">     A</code></div>
<div class="line"><code class="plain">     </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> arr[] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    method(arr,</code><code class="value">10</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>直接使用宏定义函数</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define MYPRINT(X,Y) </code><code class="keyword">for</code><code class="plain">(</code><code class="keyword">int</code><code class="plain"> i=</code><code class="value">0</code><code class="plain">;i&lt;(Y);i++)\</code></div>
<div class="line"><code class="plain">{\</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d \n"</code><code class="plain">,(X)[i]);\</code></div>
<div class="line"><code class="plain">}\</code></div>
<div class="line"><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;\</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> arr[] = {</code><code class="value">1</code><code class="plain">,</code><code class="value">2</code><code class="plain">,</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">,</code><code class="value">5</code><code class="plain">,</code><code class="value">6</code><code class="plain">,</code><code class="value">7</code><code class="plain">,</code><code class="value">8</code><code class="plain">,</code><code class="value">9</code><code class="plain">,</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    MYPRINT(arr,</code><code class="value">10</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>使用宏定义函数和普通函数的区别：使用宏比较节省空间，因为使用宏定义函数，没有堆栈提升操作，也就是不会作为函数调用而是直接内联到代码内。</p>
    <div class="section section-3" id="src-12714021_safe-id-Q-ivreiogC3lro_lrprkuYnnmoTms6jmhI_kuovpobk">
        <h3 class="heading "><span>&#23439;&#23450;&#20041;&#30340;&#27880;&#24847;&#20107;&#39033;</span></h3>
<ol class=" "><li class=" "><p   
>只做字符序列的替换工作，不做任何语法检测，在编译前处理</p>
</li><li class=" "><p   
>宏名标识符与左圆括号之前不允许有空白符，应紧接在一起</p>
</li><li class=" "><p   
>为了避免出错，宏定义中给形参加上括号</p>
</li><li class=" "><p   
>多行声明时，回车换行前要加上字符'\'，注意字符'\'后要紧跟回车键，中间不能有空格或其他字符</p>
</li><li class=" "><p   
>末尾不需要分号</p>
</li></ol>    </div>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3mnaHku7bnvJbor5HkuI7mlofku7bljIXlkKs">
        <h2 class="heading "><span>&#26465;&#20214;&#32534;&#35793;&#19982;&#25991;&#20214;&#21253;&#21547;</span></h2>
<p   
>条件编译，就是当满足条件时才会要求编译器进行编译；如下代码当if成立则变异printf，否则就不编译：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">#</code><code class="keyword">if</code><code class="plain"> </code><code class="value">0</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"--------"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">#endif</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>应用场景：</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define DEBUG </code><code class="value">0</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">#</code><code class="keyword">if</code><code class="plain"> DEBUG</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"--------"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">#endif</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>可以通过反汇编代码来看一下：</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/12714021/image2021-3-12_0-2-7.png" alt="images/download/attachments/12714021/image2021-3-12_0-2-7.png" width="600"  />
    </p>
<p   
>可以看见printf根本没有进行编译。</p>
<p   
>if define之类的，我们都称之为预处理指令，如下是常用的。</p>
    <div class="section section-3" id="src-12714021_safe-id-Q-ivreiogC3pooTlpITnkIbmjIfku6TvvJrmnaHku7bnvJbor5HmmK_pgJrov4fpooTlpITnkIbmjIfku6Tlrp7njrDnmoQ">
        <h3 class="heading "><span>&#39044;&#22788;&#29702;&#25351;&#20196;&#65306;&#26465;&#20214;&#32534;&#35793;&#26159;&#36890;&#36807;&#39044;&#22788;&#29702;&#25351;&#20196;&#23454;&#29616;&#30340;</span></h3>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>指令</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>用途</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#define</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>定义宏</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#undef</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>取消已定义的宏</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#if</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>如果给定条件为真，则编译下面代码</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#endif</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>如果前面的#if给定条件不为真，当前条件为真，则编译下面代码</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#else</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>同else</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#endif</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>结束一个#if&hellip;#else条件编译块</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#ifdef</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>如果宏已经定义，则编译下面代码</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#ifndef</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>如果宏没有定义，则编译下面代码</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>#include</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>包含文件</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    </div>
    <div class="section section-2" id="src-12714021_safe-id-Q-ivreiogC3mlofku7bljIXlkKs">
        <h2 class="heading "><span>&#25991;&#20214;&#21253;&#21547;</span></h2>
<p   
>文件包含有两种格式，分别是 #include &quot;file&quot; 和 #include &lt;file&gt;</p>
<p   
>使用双引号：系统首先到当前目录下查找被包含的文件，如果没找到，再到系统指定的包含文件目录(由用户在配置环境时设置)去找<br/>使用尖括号：直接到系统指定的包含文件目录去查找</p>
<p   
>所以<strong class=" ">系统文件用 &lt;&gt; 尖括号，自己定义的文件用 &quot;&quot; 双引号</strong>。</p>
<p   
>文件包含可能会存在重复包含的情况，我们可以使用条件编译、前置声明的方式避免。</p>
<p   
></p>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#27719;&#32534;&#35821;&#35328;</span>
        </a>
                <a href="C%2B%2B%E8%AF%AD%E8%A8%80.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>C++&#35821;&#35328;</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
